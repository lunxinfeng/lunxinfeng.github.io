<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="风少侠的个人博客">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="风少侠的个人博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="风少侠的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>风少侠的个人博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">风少侠的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/JavaFX属性与绑定/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/JavaFX属性与绑定/" itemprop="url">JavaFX属性与绑定</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:47:37+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><p>　　在类Bill中定义一个amoutDue属性：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> javafx.beans.property.DoubleProperty;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> javafx.beans.property.SimpleDoubleProperty;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bill</span> </span>&#123;</span><br><span class="line">      <span class="comment">// 定义一个变量存储属性</span></span><br><span class="line">      <span class="keyword">private</span> DoubleProperty amountDue = <span class="keyword">new</span> SimpleDoubleProperty();</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 定义一个getter方法获取属性值</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">double</span> <span class="title">getAmountDue</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> amountDue.get();&#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 定义一个setter方法设置属性值</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">setAmountDue</span><span class="params">(<span class="keyword">double</span> value)</span></span>&#123;amountDue.set(value);&#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 定义一个getter方法获取属性本身</span></span><br><span class="line">      <span class="function"><span class="keyword">public</span> DoubleProperty <span class="title">amountDueProperty</span><span class="params">()</span> </span>&#123;<span class="keyword">return</span> amountDue;&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  amountDue对象是javafx.beans.property.DoubleProperty的一个实例，并使用private对其进行了标记，从而将其封装起来与外部隔离。这是Java和JavaBeans应用开发中的一个标准做法。注意虽然这个对象的类型不是标准Java基本类型，而是一个新的包装类，其中封装了基本类型并增加了一些额外方法(javafx.beans.property包下的类的设计中都包含了对可观察性和绑定的内建支持，property包下包含了各种数据类型的property封装)。</p>
<p>　　属性方法的命名规范如下：</p>
<ul>
<li>getAmountDue()方法是标准的取值方法(getter)，返回了amountDue属性的当前值。按照规范，这个方法应该声明为final。需要注意这个方法的返回类型为double，而不是DoubleProperty。</li>
<li>setAmountDue(double)方法(同样也是final的)是一个标准的设值方法(setter)，它允许调用者设置属性值。setter方法是可选的。其参数类型同样也是double。</li>
<li>最后，amountDueProperty()方法定义了属性的getter方法。这是一条新规范，它要求方法名包含属性名(在本例中是amountDue),以单词Property结尾。返回类型与属性本身一致(在本例中是DoubleProperty)。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-7ea70f07f6dea58f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="property.jpg"></p>
<p>  上面提到了，javafx.beans.property包下的类的设计中都包含了对可观察性和绑定的内建支持，我们可以添加一个监听器来监听属性的改变：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Bill electricBill = <span class="keyword">new</span> Bill();</span><br><span class="line">        electricBill.amountDueProperty().addListener(<span class="keyword">new</span> ChangeListener()&#123;</span><br><span class="line">             <span class="meta">@Override</span></span><br><span class="line">             <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changed</span><span class="params">(ObservableValue o,Object oldVal,Object newVal)</span></span>&#123;</span><br><span class="line">                  System.out.println(<span class="string">"Electric bill has changed!"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        electricBill.setAmountDue(<span class="number">100.00</span>);<span class="comment">//当amoutDue值改变时，会打印出上面那句话</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="绑定"><a href="#绑定" class="headerlink" title="绑定"></a>绑定</h2><h3 id="使用高级绑定api"><a href="#使用高级绑定api" class="headerlink" title="使用高级绑定api"></a>使用高级绑定api</h3><p>　　高级API是在你的应用程序中开始使用绑定的最简单快捷的方法。它包含两部分：Fluent API和Binding类。Fluent API在各种依赖对象上暴露方法，而Binding类提供了静态工厂方法。</p>
<p>　　要开始使用Fluent API时，可以考虑这样一个简单的例子：有两个整数被绑定在一起，所以它们的值总是被相加到一起。在例1-3中包含三个变量：num1(依赖变量)，num2(依赖变量)和sum(绑定变量)。依赖变量的类型都是IntegerProperty，而绑定变量的类型是NumberBinding。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        IntegerProperty num1 = <span class="keyword">new</span> SimpleIntegerProperty(<span class="number">1</span>);</span><br><span class="line">        IntegerProperty num2 = <span class="keyword">new</span> SimpleIntegerProperty(<span class="number">2</span>);</span><br><span class="line">        NumberBinding sum = num1.add(num2);</span><br><span class="line">        System.out.println(sum.getValue());<span class="comment">//3</span></span><br><span class="line">        num1.set(<span class="number">2</span>);</span><br><span class="line">        System.out.println(sum.getValue());<span class="comment">//4,说明绑定有效</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　你也可以使用Bindings类(同样binding包下也包含了一系列数据类型的binding类)来做同样的事:<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        IntegerProperty num1 = <span class="keyword">new</span> SimpleIntegerProperty(<span class="number">1</span>);</span><br><span class="line">        IntegerProperty num2 = <span class="keyword">new</span> SimpleIntegerProperty(<span class="number">2</span>);</span><br><span class="line">        NumberBinding sum = Bindings.add(num1,num2);</span><br><span class="line">        System.out.println(sum.getValue());<span class="comment">//3</span></span><br><span class="line">        num1.setValue(<span class="number">2</span>);</span><br><span class="line">        System.err.println(sum.getValue());<span class="comment">//4</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="使用低级绑定api"><a href="#使用低级绑定api" class="headerlink" title="使用低级绑定api"></a>使用低级绑定api</h3><p>　　低级API相比高级API为开发者提供了更高的灵活性(或更高性能)。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">final</span> DoubleProperty a = <span class="keyword">new</span> SimpleDoubleProperty(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">final</span> DoubleProperty b = <span class="keyword">new</span> SimpleDoubleProperty(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">final</span> DoubleProperty c = <span class="keyword">new</span> SimpleDoubleProperty(<span class="number">3</span>);</span><br><span class="line">        <span class="keyword">final</span> DoubleProperty d = <span class="keyword">new</span> SimpleDoubleProperty(<span class="number">4</span>);</span><br><span class="line">        DoubleBinding db = <span class="keyword">new</span> DoubleBinding() &#123;</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">super</span>.bind(a, b, c, d);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">protected</span> <span class="keyword">double</span> <span class="title">computeValue</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">return</span> (a.get() * b.get()) + (c.get() * d.get());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        System.out.println(db.get());</span><br><span class="line"></span><br><span class="line">        b.set(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        System.out.println(db.get());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　使用低级API包括对某一个绑定类进行扩展并重写其computeValue()方法以返回绑定的当前值。上例中使用了DoubleBinding 的一个自定义子类。子类中调用super.bind()方法将依赖变量向上传递给了DoubleBinding类，所以默认的失效行为会被保留。一般不需要检查绑定是否是失效；基类会为你提供这种行为。</p>
<h3 id="探索Observable-ObservableValue-InvalidationListener和ChangeListener"><a href="#探索Observable-ObservableValue-InvalidationListener和ChangeListener" class="headerlink" title="探索Observable, ObservableValue, InvalidationListener和ChangeListener"></a>探索Observable, ObservableValue, InvalidationListener和ChangeListener</h3><p>　　绑定API定义了一系列的接口，可以做到当一个值发生改变或者失效时可以通知对象。Observable与ObservableValue接口触发改变通知，而InvalidationListener和ChangeListener接口接收通知。</p>
<p>　　两者的区别是Observable中只有添加和删除InvalidationListener的方法，ObservableValue继承于Observable，并新增了添加和删除ChangeListener的方法。</p>
<p>　　ChangeListener每次ObservableValue值改变的时候都会触发，InvalidationListener在Observable的某一个依赖变量改变时触发，并且只能触发一次，直到Observable再次变得有效（被访问）。</p>
<p>　　JavaFX绑定与属性的实现都支持延迟计算(lazy evaluation)，意思是当改变发生时值并不是立即重新计算。当此值随后被请求时才进行重新计算。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Bill bill1 = <span class="keyword">new</span> Bill();</span><br><span class="line">        Bill bill2 = <span class="keyword">new</span> Bill();</span><br><span class="line">        Bill bill3 = <span class="keyword">new</span> Bill();</span><br><span class="line">        NumberBinding total =Bindings.add(bill1.amountDueProperty().add(bill2.amountDueProperty()),bill3.amountDueProperty());</span><br><span class="line"></span><br><span class="line">        total.addListener(<span class="keyword">new</span> InvalidationListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invalidated</span><span class="params">(Observable o)</span> </span>&#123;</span><br><span class="line">                System.out.println(<span class="string">"The binding is now invalid."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 某个依赖变量改变使绑定失效</span></span><br><span class="line">        bill1.setAmountDue(<span class="number">200.00</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 不会触发InvalidationListener，因为已经失效了</span></span><br><span class="line">        bill2.setAmountDue(<span class="number">100.00</span>);</span><br><span class="line">        bill3.setAmountDue(<span class="number">75.00</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 使绑定恢复有效，并重新计算值</span></span><br><span class="line">        System.out.println(total.getValue());</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定失效</span></span><br><span class="line">        bill3.setAmountDue(<span class="number">150.00</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 绑定有效</span></span><br><span class="line">        System.out.println(total.getValue());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/一个java程序员的python之旅：初识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/一个java程序员的python之旅：初识/" itemprop="url">一个java程序员的python之旅：初识</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:46:49+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>  记录一下自己的python学习之旅，入门书籍为《python编程：从入门到实践》，运行环境为python3.6.3。也有一定的编程基础，对于一些通用的语法不再赘述，本篇主要记录一下python一些不同于java的<strong>基本语法</strong>。</p>
<h1 id="书写格式"><a href="#书写格式" class="headerlink" title="书写格式"></a>书写格式</h1><ul>
<li>一句代码的结束以换行为标志，不需要分号。</li>
<li>建议每级缩进都使用四个空格。</li>
<li>建议每行不超过80字符，建议注释的行长不超过72字符。</li>
<li>不同的逻辑之间可用一个空行隔开。</li>
<li>代码块不需要大括号，python根据缩进来判断代码行与前一个代码行的关系。</li>
<li>python变量和函数命名习惯采用小写，可用下划线隔开，不像java采用驼峰命名法。</li>
<li>在条件测试的格式设置方面，建议在诸如== 、&gt;= 和&lt;= 等比较运算符两边各添加一个空格。<h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1>变量不需要声明。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">message = <span class="string">"Hello Python"</span></span><br><span class="line">print(message)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><ul>
<li>字符串可以用双引号，也可以用单引号，这样可以方便的在字符串中使用引号，当然也可以像java一下通过转义字符表示引号。</li>
<li>python中的字符串也封装了许多的基本操作方法，比如大小写转换，去首尾空格等，可以在使用过程中慢慢去熟悉。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">message = <span class="string">" Hello world "</span></span><br><span class="line">print(message.title())  <span class="comment"># 首字母大写</span></span><br><span class="line">print(message.lower())  <span class="comment"># 转换小写</span></span><br><span class="line">print(message.upper())  <span class="comment"># 转换大写</span></span><br><span class="line">print(message.count(<span class="string">"o"</span>))  <span class="comment"># 字符计数</span></span><br><span class="line">print(message.strip())  <span class="comment"># 去首尾空格</span></span><br><span class="line">print(message.lstrip())  <span class="comment"># 去开头空格</span></span><br><span class="line">print(message.rstrip())  <span class="comment"># 去结尾空格</span></span><br><span class="line">print(message.__len__())  <span class="comment"># 字符串长度</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h1><ul>
<li>数字和字符串不能直接拼接。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="string">"Hello "</span> + <span class="number">213</span>)  <span class="comment"># TypeError: must be str, not int</span></span><br><span class="line">print(<span class="string">"Hello "</span> + str(<span class="number">213</span>))  <span class="comment"># Hello 213</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h2><ul>
<li>python中可以用 ** 表示乘方运算</li>
<li>python3中两个整数相除时，会得到真实的结果，而python2中只会得到整数部分，这与java类似（3/2=1）。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(<span class="number">2</span> ** <span class="number">3</span>)  <span class="comment"># 8</span></span><br><span class="line">print(<span class="number">3</span> / <span class="number">2</span>)  <span class="comment"># 1.5</span></span><br><span class="line">print(<span class="number">4</span> / <span class="number">3</span>)  <span class="comment"># 1.3333333333333333</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h1><ul>
<li>python中注释用#来表示。<h1 id="列表"><a href="#列表" class="headerlink" title="列表"></a>列表</h1>有序集合，用[]表示。类似于但又不同于java中的数组、集合。</li>
<li>python中的列表不要求数据类型相同，及不用类型的数据可以放到同一个列表中，姑且简单理解为List<object>。</object></li>
<li><p>有序集合，因此支持按索引访问，索引从0开始。不同的是python还支持反向索引，-1代表最后一个数据，-2代表倒数第二个，依次类推。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">"Allen"</span>, <span class="string">"Toto"</span>, <span class="number">123</span>]</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 'Toto', 123]</span></span><br><span class="line">print(names[<span class="number">1</span>])  <span class="comment"># Toto</span></span><br><span class="line">print(names[<span class="number">-1</span>])  <span class="comment"># 123</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>修改元素：类似于java数组，直接通过索引赋值修改。</p>
</li>
<li>添加元素：提供append和insert方法，分别用于在列表末尾追加和在指定索引位置插入新元素。</li>
<li><p>删除元素：提供pop和remove方法，分别用于删除指定索引和指定值的元素。也可用del语句来删除。注意remove方法只是删除一个元素，如果列表中有多个相同元素，可以通过循环删除。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">"Allen"</span>, <span class="string">"Toto"</span>, <span class="number">123</span>]</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 'Toto', 123]</span></span><br><span class="line">names[<span class="number">2</span>] = <span class="number">456</span></span><br><span class="line">print(names)  <span class="comment"># ['Allen', 'Toto', 456]</span></span><br><span class="line">names.append(<span class="keyword">True</span>)</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 'Toto', 456, True]</span></span><br><span class="line">names.insert(<span class="number">1</span>, <span class="number">123</span>)</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 123, 'Toto', 456, True]</span></span><br><span class="line"><span class="keyword">del</span> names[<span class="number">-1</span>]</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 123, 'Toto', 456]</span></span><br><span class="line">test = names.pop(<span class="number">-1</span>)</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 123, 'Toto']</span></span><br><span class="line">print(test)  <span class="comment"># 456</span></span><br><span class="line">names.remove(<span class="string">"Allen"</span>)</span><br><span class="line">print(names)  <span class="comment"># [123, 'Toto']</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>排序：注意只有所有元素为相同类型的列表可以排序。可以通过列表的sort方法或者sorted函数来进行排序，其中sort会改变原列表，sorted不会改变原列表。也可以通过参数来控制顺序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">"Allen"</span>, <span class="string">"Toto"</span>, <span class="string">"Lili"</span>]</span><br><span class="line">names.sort()</span><br><span class="line">print(names)  <span class="comment"># ['Allen', 'Lili', 'Toto']</span></span><br><span class="line">names.sort(reverse=<span class="keyword">True</span>)</span><br><span class="line">print(names)  <span class="comment"># ['Toto', 'Lili', 'Allen']</span></span><br><span class="line">print(sorted(names))  <span class="comment"># ['Allen', 'Lili', 'Toto']</span></span><br><span class="line">print(names)  <span class="comment"># ['Toto', 'Lili', 'Allen']</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历：通过for循环进行遍历，类似于java中的foreach语句，仅仅是写法不同。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">names = [<span class="string">"Allen"</span>, <span class="string">"Toto"</span>, <span class="string">"Lili"</span>]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> names:  <span class="comment"># 注意最后有个冒号,代码块需要缩进</span></span><br><span class="line">    print(item)</span><br></pre></td></tr></table></figure>
</li>
<li><p>数值列表：python使用range函数可以很方便的创建一个数值列表，结果符合编程中最常见的差一行为，比如range(1,6)，实际生成的为1到5这五个数字。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nums = list(range(<span class="number">1</span>, <span class="number">6</span>))  <span class="comment"># 创建数值列表</span></span><br><span class="line">print(nums)  <span class="comment"># [1, 2, 3, 4, 5]</span></span><br><span class="line"><span class="comment"># range还支持步数</span></span><br><span class="line">nums = list(range(<span class="number">1</span>, <span class="number">6</span>, <span class="number">2</span>))  <span class="comment"># [1, 3, 5]</span></span><br><span class="line">print(nums)</span><br></pre></td></tr></table></figure>
</li>
<li><p>列表解析：将for循环和创建新元素的代码合并成一行，并自动附加新元素。下面两种写法是等价的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">nums = list()</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>):</span><br><span class="line">    nums.append(item ** item)</span><br><span class="line">print(nums)  <span class="comment"># [1, 4, 27, 256, 3125]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 列表解析的格式为[表达式 + for循环]</span></span><br><span class="line">nums = [item ** item <span class="keyword">for</span> item <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">6</span>)]</span><br><span class="line">print(nums)  <span class="comment"># [1, 4, 27, 256, 3125]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>切片：即截取列表的部分相邻元素。通过指定要截取的第一个和最后一个索引来进行切片，并得到一个<strong>新的列表</strong>。依然符合差一行为。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">nums = list(range(<span class="number">1</span>, <span class="number">11</span>))</span><br><span class="line"><span class="comment"># 实际上是从索引1到4</span></span><br><span class="line">print(nums[<span class="number">1</span>:<span class="number">5</span>])  <span class="comment"># [2, 3, 4, 5]</span></span><br><span class="line"><span class="comment"># 没有指定开始索引会默认从0开始  没指定结束索引会默认到列表最后一个元素结束</span></span><br><span class="line">print(nums[:<span class="number">5</span>])  <span class="comment"># [1, 2, 3, 4, 5]</span></span><br><span class="line">print(nums[<span class="number">5</span>:])  <span class="comment"># [6, 7, 8, 9, 10]</span></span><br><span class="line">print(nums[:])  <span class="comment"># [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</span></span><br><span class="line"><span class="comment"># 也支持负索引</span></span><br><span class="line">print(nums[<span class="number">-3</span>:])  <span class="comment"># [8, 9, 10]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表的复制：列表的复制可以直接使用切片的方式，不能直接将变量赋值给另一个变量，这和java中的概念（list.addAll）是相同的。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这样相当于将变量nums和nums_2都关联到了同一个列表，不是复制</span></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">nums_2 = nums</span><br><span class="line">nums_2.append(<span class="number">4</span>)</span><br><span class="line">print(nums_2)  <span class="comment"># [1, 2, 3, 4]</span></span><br><span class="line">print(nums)  <span class="comment"># [1, 2, 3, 4]</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 可以用切片来达到复制列表的目的</span></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">nums_2 = nums[:]</span><br><span class="line">nums_2.append(<span class="number">4</span>)</span><br><span class="line">print(nums_2)  <span class="comment"># [1, 2, 3, 4]</span></span><br><span class="line">print(nums)  <span class="comment"># [1, 2, 3]</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h1><p>  python将不可修改的值称为不可变的，而不可变的列表称为元组。</p>
<ul>
<li>元组使用圆括号标识，除了元素不可变之外，可以向操作列表一样遍历、操作元组。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 元组：不可变的列表</span></span><br><span class="line">nums = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">print(nums)  <span class="comment"># (1, 2, 3)</span></span><br><span class="line">print(nums[<span class="number">-2</span>:])  <span class="comment"># (2, 3)</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="if语句"><a href="#if语句" class="headerlink" title="if语句"></a>if语句</h1><p>语法同大多数编程语言，仅仅是书写格式不同。</p>
<ul>
<li>条件判断:<ul>
<li>区分大小写，如果不想区分大小写判断是否相等，可以先都转换成小写再判断。</li>
<li>支持==、&gt;、&lt;、&gt;=、&lt;=、!=判断。</li>
<li>多个判断条件可以使用<strong>and</strong>和<strong>or</strong>关键字，效果等于java中的&amp;&amp;和||。</li>
<li>判断元素是否包含在某个列表中时，可以使用<strong>in</strong>和<strong>not in</strong>关键字。</li>
<li>python在进行条件判断时，会将非空的字符串或列表认为True，反之为False。<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">"a"</span></span><br><span class="line">b = <span class="string">"A"</span></span><br><span class="line"><span class="keyword">if</span> a == b:  <span class="comment"># a.lower() == b.lower()</span></span><br><span class="line">    print(<span class="string">"a == b"</span>)</span><br><span class="line"><span class="keyword">elif</span> a.lower() == b.lower():</span><br><span class="line">    print(<span class="string">"a.lower() == b.lower()"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">nums_2 = [<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">if</span> (<span class="number">3</span> <span class="keyword">in</span> nums) <span class="keyword">and</span> (<span class="number">3</span> <span class="keyword">not</span> <span class="keyword">in</span> nums_2):  <span class="comment"># False</span></span><br><span class="line">    print(<span class="keyword">True</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="keyword">False</span>)</span><br><span class="line"></span><br><span class="line">nums = []</span><br><span class="line">a = <span class="string">"a"</span></span><br><span class="line"><span class="keyword">if</span> nums:  <span class="comment"># a</span></span><br><span class="line">    print(<span class="string">"nums"</span>)</span><br><span class="line"><span class="keyword">elif</span> a:</span><br><span class="line">    print(<span class="string">"a"</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    print(<span class="keyword">False</span>)</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h1 id="字典"><a href="#字典" class="headerlink" title="字典"></a>字典</h1><p>在Python中，字典是一系列<strong>键–值对</strong> 。每个键都与一个值相关联，你可以使用键来访问与之相关联的值。与键相关联的值可以是数字、字符串、列表乃至字典。事实上，可将任何Python对象用作字典中的值。类似于java中的Map。</p>
<ul>
<li><p>python中，字典用花括号来标识，每一个键值对之间以逗号分隔。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">student = &#123;<span class="string">"name"</span>: <span class="string">"Allen"</span>, <span class="string">"age"</span>: <span class="number">15</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>可以通过字典的键来访问与之关联的值。</p>
</li>
<li>字典是一种动态结构，可随时在其中添加、修改键值对，只需指定字典的键即可。</li>
<li><p>可以通过del语句删除字典中的键值对。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">student = &#123;<span class="string">"name"</span>: <span class="string">"Allen"</span>, <span class="string">"age"</span>: <span class="number">15</span>&#125;</span><br><span class="line">print(student[<span class="string">"name"</span>])  <span class="comment"># Allen</span></span><br><span class="line">student[<span class="string">"name"</span>] = <span class="string">"Lili"</span></span><br><span class="line">print(student)  <span class="comment"># &#123;'name': 'Lili', 'age': 15&#125;</span></span><br><span class="line">student[<span class="string">"address"</span>] = <span class="string">"ChangSha"</span></span><br><span class="line">print(student)  <span class="comment"># &#123;'name': 'Lili', 'age': 15, 'address': 'ChangSha'&#125;</span></span><br><span class="line"><span class="keyword">del</span> student[<span class="string">"address"</span>]</span><br><span class="line">print(student)  <span class="comment"># &#123;'name': 'Lili', 'age': 15&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>可以通过for循环遍历字典的所有键、所有值或者是所有的键值对。<strong>但是不保证遍历顺序和存储顺序相同。</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">student = &#123;<span class="string">'name'</span>: <span class="string">'Lili'</span>, <span class="string">'age'</span>: <span class="number">15</span>, <span class="string">'address'</span>: <span class="string">'ChangSha'</span>&#125;</span><br><span class="line"><span class="keyword">for</span> k, v <span class="keyword">in</span> student.items():</span><br><span class="line">    print(str(k) + <span class="string">":"</span> + str(v))</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> student.keys():  <span class="comment"># 遍历字典时会默认遍历key，因此等效于 for k in student:</span></span><br><span class="line">    print(k)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> v <span class="keyword">in</span> set(student.values()):  <span class="comment"># 如果需要去重的话，可以使用集合set，类似于列表，但每个元素都是独一无二的</span></span><br><span class="line">    print(v)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="while循环"><a href="#while循环" class="headerlink" title="while循环"></a>while循环</h1><p>  基本语法同大多数编程语言，仅书写格式不同。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nums = [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">3</span>]</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span> <span class="keyword">in</span> nums:</span><br><span class="line">    nums.remove(<span class="number">1</span>)</span><br><span class="line">print(nums)  <span class="comment"># [2, 2, 3]</span></span><br></pre></td></tr></table></figure></p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><ul>
<li>函数用关键词def定义，函数体依然采用缩进方式。</li>
<li><p>函数的说明文档用三引号注释，写在函数体的第一行。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_hello</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""打招呼"""</span></span><br><span class="line">    print(<span class="string">"Hello"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print_hello()  <span class="comment"># Hello</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>参数传递：python中实参的传递有三种方式：位置实参，关键字实参和默认值。<strong>位置实参</strong>即基于实参的顺序依次传递，这是大多数编程语言中的一种普遍做法。<strong>关键字实参</strong>通过键值对的方式传递参数，不用考虑参数的顺序。<strong>默认值</strong>即在编写函数时为形参指定一个默认值，调用函数时如果不指定实参，则使用此默认值。注意如果不指定默认值，则调用函数时必须传入该实参。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">print_hello</span><span class="params">(name, age=<span class="string">"15"</span>)</span>:</span></span><br><span class="line">    <span class="string">"""打招呼"""</span></span><br><span class="line">    print(<span class="string">"你好，我叫"</span> + str(name) + <span class="string">"，"</span> + str(age) + <span class="string">"岁"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print_hello(<span class="string">"李狗蛋"</span>, <span class="string">"12"</span>)  <span class="comment"># 你好，我叫李狗蛋，12岁</span></span><br><span class="line">print_hello(<span class="string">"12"</span>, <span class="string">"李狗蛋"</span>)  <span class="comment"># 你好，我叫12，李狗蛋岁</span></span><br><span class="line">print_hello(age=<span class="string">"12"</span>, name=<span class="string">"李狗蛋"</span>)  <span class="comment"># 你好，我叫李狗蛋，12岁</span></span><br><span class="line"><span class="comment"># 形参可以有默认值，相当于简化了java中的方法的多态</span></span><br><span class="line">print_hello(<span class="string">"李狗蛋"</span>)  <span class="comment"># 你好，我叫李狗蛋，15岁</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>返回值：python中函数可以通过关键字return返回一个值，且python是弱类型语言，无需指定返回的值的类型。</p>
</li>
<li><p>列表作为实参传入时，如果函数内部对该列表做了修改，则原列表也会改变，这一点同java是一样的。如果不想修改原列表，可以将列表的一个副本作为实参传入，比如使用切片。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">getList</span><span class="params">(list)</span>:</span></span><br><span class="line">    list[<span class="number">0</span>] = <span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> list</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">print(getList(a))  <span class="comment"># [2, 2]</span></span><br><span class="line">print(a)  <span class="comment"># [2, 2]</span></span><br><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">print(getList(a[:]))  <span class="comment"># [2, 2]</span></span><br><span class="line">print(a)  <span class="comment"># [1, 2]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数可以使用 *+形参名 的形式添加任意数量的参数，类似于java中的 形参名+… 符号，如果有多个不同类型的形参，这种接收任意数量参数的形参只能放在最后。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">muti</span><span class="params">(*name)</span>:</span>  <span class="comment"># 形参名*name 中的星号让Python创建一个名为name 的空元组，并将收到的所有值都封装到这个元组中。</span></span><br><span class="line">    print(name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">muti(<span class="string">"a"</span>)  <span class="comment"># ('a',)</span></span><br><span class="line">muti(<span class="string">"a"</span>, <span class="string">"b"</span>, <span class="string">"c"</span>)  <span class="comment"># ('a', 'b', 'c')</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>函数可以通过两个星号来接收任意数量的关键字实参（键值对）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">person</span><span class="params">(name, age, **other)</span>:</span>  <span class="comment"># 形参名**other 中的星号让Python创建一个名为other 的空字典，并将收到的所有键值对都封装到这个字典中。</span></span><br><span class="line">    p = &#123;<span class="string">"name"</span>: name, <span class="string">"age"</span>: age&#125;</span><br><span class="line">    <span class="keyword">for</span> k, v <span class="keyword">in</span> other.items():</span><br><span class="line">        p[k] = v</span><br><span class="line">    print(other)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">person(<span class="string">"Allen"</span>, <span class="number">15</span>, sex=<span class="string">"man"</span>, address=<span class="string">"ChangSha"</span>)  <span class="comment"># &#123;'name': 'Allen', 'age': 15, 'sex': 'man', 'address': 'ChangSha'&#125;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>导入外部函数：要让函数是可导入的，得先创建模块。<strong>模块</strong>是扩展名为.py的文件，包含要导入到程序中的代码。导入方式：</p>
<ul>
<li>import module_name：导入整个模块。</li>
<li>import module_name as other_name：为导入的模块起一个别名。</li>
<li>from module_name import function_name：导入模块中的某个函数，function_name可以有多个，用逗号隔开，表示导入该模块的多个函数。</li>
<li>from module_name import function_name as other_name：导入模块中的某个函数，并起一个别名，一般原函数名字太长或者有同名函数时使用。</li>
<li>from module_name import *：导入该模块的全部函数。<br>注：只导入模块时，需通过module_name.function_name调用（前两种方式），导入函数时，可以直接通过函数名使用（后三种方式）。当然，有别名的情况下也可以使用别名。</li>
</ul>
</li>
</ul>
<h1 id="类"><a href="#类" class="headerlink" title="类"></a>类</h1><ul>
<li>通过关键字class标识，类名的首字母大写，采用驼峰命名法，可以在类名的下一行添加注释文档，用三引号标识。</li>
<li>python的类有一个特殊的方法<strong> init</strong>()，每次创建类的实例时都会运行这个方法，类似于java中的构造函数。在这个方法的名称中，开头和末尾各有两个下划线，这是一种约定，旨在避免Python默认方法与普通方法发生名称冲突。</li>
<li>形参self必不可少，还必须位于其他形参的前面。每个与类相关联的方法调用都自动传递实参self ，它是一个指向实例本身的引用，让实例能够访问类中的属性和方法。</li>
<li><p>以self 为前缀的变量都可供类中的所有方法使用，我们还可以通过类的任何实例来访问这些变量，我们可以将这些以self为前缀的变量称为属性。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="string">"""测试类"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name=<span class="string">"Allen"</span>, age=<span class="number">15</span>, sex=<span class="string">"man"</span>)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.address = <span class="string">""</span></span><br><span class="line">        print(<span class="string">"person "</span> + name + <span class="string">" init"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">walk</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self.name + <span class="string">" can walk."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.walk()</span><br><span class="line">        print(self.name + <span class="string">" can run too."</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>继承。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:</span></span><br><span class="line">    <span class="string">"""测试类"""</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name, age=<span class="number">15</span>, sex=<span class="string">"man"</span>)</span>:</span></span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        self.sex = sex</span><br><span class="line">        self.address = <span class="string">""</span></span><br><span class="line">        print(<span class="string">"person "</span> + name + <span class="string">" init"</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">walk</span><span class="params">(self)</span>:</span></span><br><span class="line">        print(self.name + <span class="string">" can walk."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">run</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.walk()</span><br><span class="line">        print(self.name + <span class="string">" can run too."</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">person = Person(<span class="string">"Allen"</span>)  <span class="comment"># person Allen init</span></span><br><span class="line">person.run()  <span class="comment"># Allen can walk.  Allen can run too.</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span><span class="params">(Person)</span>:</span>  <span class="comment"># Student继承于Person</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, name)</span>:</span>  <span class="comment"># 子类的__init__方法需要接收父类的所有参数，有默认值的可以不传，会取默认值</span></span><br><span class="line">        super().__init__(name)  <span class="comment"># 子类继承父类的所有属性和方法</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">walk</span><span class="params">(self)</span>:</span>  <span class="comment"># 重写父类方法</span></span><br><span class="line">        print(<span class="string">"override function."</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_teacher</span><span class="params">(self, teacher_name)</span>:</span>  <span class="comment"># 子类的自定义方法</span></span><br><span class="line">        print(self.name + <span class="string">"'s teacher is "</span> + teacher_name)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">student = Student(<span class="string">"Allen"</span>)  <span class="comment"># person Allen init</span></span><br><span class="line">student.get_teacher(<span class="string">"Lili"</span>)  <span class="comment"># Allen's teacher is Lili</span></span><br><span class="line">student.walk()  <span class="comment"># override function.</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="文件读写"><a href="#文件读写" class="headerlink" title="文件读写"></a>文件读写</h1><p>通过open函数打开一个文件，进行读写操作，完成后通过close函数关闭文件，也可以使用with关键字，让python自己选择适时关闭文件。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">open</span><span class="params">(file, mode=<span class="string">'r'</span>, buffering=None, encoding=None, errors=None, newline=None, closefd=True)</span>:</span></span><br></pre></td></tr></table></figure></p>
<p>open函数可以接收一个mode参数，包括以下值：</p>
<ul>
<li>‘r’       只读方式打开 (default)</li>
<li>‘w’      只写方式打开，打开文件会清空文件，再写入，文件不存在时会自动创建文件。</li>
<li>‘x’       创建一个新文件并以只写方式打开</li>
<li>‘a’       只写方式打开，打开文件会将写入内容拼接到文件最后，</li>
<li>‘b’       字节模式</li>
<li>‘t’       文本模式(default)</li>
<li>‘+’       打开一个硬盘文件进行更新 (reading and writing)</li>
<li>‘U’       universal newline mode (已过时)</li>
</ul>
<p>默认模式为”rt”。</p>
<h2 id="读文件"><a href="#读文件" class="headerlink" title="读文件"></a>读文件</h2><p>测试文件 file_io_test：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">abcdefg</span><br><span class="line">hijklmn</span><br><span class="line">opq</span><br><span class="line">rst</span><br><span class="line">uvw</span><br><span class="line">xyz</span><br></pre></td></tr></table></figure></p>
<ul>
<li><p>读取整个文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"file_io_test"</span>) <span class="keyword">as</span> file:  <span class="comment"># 关键字with 在不再需要访问文件后适时将其关闭。</span></span><br><span class="line">    print(file.read())  <span class="comment"># read()可以接收一个int参数，表示读取的字节数，传-1表示读取全部，默认值为-1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>读取一行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"file_io_test"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    print(file.readline())  <span class="comment"># abcdefg 行末尾有一个换行符</span></span><br><span class="line">    print(file.readline())  <span class="comment"># hijklmn</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>读取每行，并存储到一个列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"file_io_test"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    print(file.readlines())  <span class="comment"># ['abcdefg\n', 'hijklmn\n', 'opq\n', 'rst\n', 'uvw\n', 'xyz']</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>逐行读取</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"file_io_test"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:  <span class="comment"># 等同于line = file.readline()</span></span><br><span class="line">        print(line)</span><br></pre></td></tr></table></figure>
</li>
<li><p>是否可读</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"file_io_test"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    print(file.readable())  <span class="comment"># readable()是否可读，返回一个布尔值</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="写文件"><a href="#写文件" class="headerlink" title="写文件"></a>写文件</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> open(<span class="string">"file_write_test"</span>, mode=<span class="string">"w+"</span>) <span class="keyword">as</span> file:  <span class="comment"># w换成a后可以附加到文件中，不会覆盖</span></span><br><span class="line">    file.write(<span class="string">"456"</span>)  <span class="comment"># 写入456</span></span><br><span class="line">    print(file.readable())  <span class="comment"># True</span></span><br></pre></td></tr></table></figure>
<h1 id="异常"><a href="#异常" class="headerlink" title="异常"></a>异常</h1><p>处理异常：<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">divide</span><span class="params">(a, b)</span>:</span></span><br><span class="line">    <span class="string">"""除法运算"""</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        result = a / b</span><br><span class="line">    <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">        print(<span class="string">"除数不能为0"</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        print(result)</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        print(<span class="string">"运行完毕"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">divide(<span class="number">1</span>, <span class="number">0</span>)  <span class="comment"># 除数不能为0  运行完毕</span></span><br><span class="line">divide(<span class="number">1</span>, <span class="number">5</span>)  <span class="comment"># 0.2  运行完毕</span></span><br></pre></td></tr></table></figure></p>
<h1 id="存储数据"><a href="#存储数据" class="headerlink" title="存储数据"></a>存储数据</h1><h2 id="通过json存储"><a href="#通过json存储" class="headerlink" title="通过json存储"></a>通过json存储</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">nums = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"jsonTest.json"</span>, <span class="string">"w"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    json.dump(nums, file)  <span class="comment"># 写入文件，接收一个内容对象和文件对象</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"jsonTest.json"</span>) <span class="keyword">as</span> file:</span><br><span class="line">    result = json.load(file)</span><br><span class="line">    print(result)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/java调用系统默认浏览器打开指定网址/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/java调用系统默认浏览器打开指定网址/" itemprop="url">java调用系统默认浏览器打开指定网址</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:45:58+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="通过api调用"><a href="#通过api调用" class="headerlink" title="通过api调用"></a>通过api调用</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (java.awt.Desktop.isDesktopSupported()) &#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">// 创建一个URI实例</span></span><br><span class="line">        java.net.URI uri = java.net.URI.create(<span class="string">"http://www.jianshu.com"</span>);</span><br><span class="line">        <span class="comment">// 获取当前系统桌面扩展</span></span><br><span class="line">        java.awt.Desktop dp = java.awt.Desktop.getDesktop();</span><br><span class="line">        <span class="comment">// 判断系统桌面是否支持要执行的功能</span></span><br><span class="line">        <span class="keyword">if</span> (dp.isSupported(java.awt.Desktop.Action.BROWSE)) &#123;</span><br><span class="line">            <span class="comment">// 获取系统默认浏览器打开链接</span></span><br><span class="line">            dp.browse(uri);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="通过cmd命令调用"><a href="#通过cmd命令调用" class="headerlink" title="通过cmd命令调用"></a>通过cmd命令调用</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    Runtime.getRuntime().exec(</span><br><span class="line">            <span class="string">"cmd /c start http://www.jianshu.com"</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/Java通过JAXB以xml的形式保存实体类数据到本地/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/Java通过JAXB以xml的形式保存实体类数据到本地/" itemprop="url">Java通过JAXB以xml的形式保存实体类数据到本地</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:45:03+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>   最近公司做了个桌面应用，登陆页面要求做个类似于QQ登陆时的账号下拉列表，需要将账号信息保存在本地，考虑了下，打算以xml的形式保存，在此做个记录。</p>
<h1 id="简单实现"><a href="#简单实现" class="headerlink" title="简单实现"></a>简单实现</h1><p>  首先来看一下需要保存的数据类，其实就是一个很普通的java实体类。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Student</span><span class="params">(<span class="keyword">int</span> id, String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(<span class="keyword">int</span> id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  因为可能要保存多个账号信息，将上述实体类做一个简单封装，作为要存储的实体类对象：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@XmlRootElement</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SaveData</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;Student&gt; students;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@XmlElement</span>(name = <span class="string">"student"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getStudents</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> students;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setStudents</span><span class="params">(List&lt;Student&gt; students)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.students = students;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>最后是数据的读取：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanToXml</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SaveData data = <span class="keyword">new</span> SaveData();</span><br><span class="line">        List&lt;Student&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        list.add(<span class="keyword">new</span> Student(<span class="number">1</span>,<span class="string">"Allen"</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> Student(<span class="number">2</span>,<span class="string">"Tom"</span>));</span><br><span class="line">        list.add(<span class="keyword">new</span> Student(<span class="number">3</span>,<span class="string">"Lili"</span>));</span><br><span class="line">        data.setStudents(list);</span><br><span class="line"></span><br><span class="line">        BeanToXml&lt;SaveData&gt; beanToXml = <span class="keyword">new</span> BeanToXml&lt;&gt;();</span><br><span class="line">        beanToXml.saveUserData(data,SaveData.class);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获取本地的保存文件  System.getProperty("user.home") 得到的是用户主目录，其他相关值见附录</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> File <span class="title">getSavePath</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        File file = <span class="keyword">new</span> File(System.getProperty(<span class="string">"user.home"</span>) + File.separator + <span class="string">"test"</span>);</span><br><span class="line">        <span class="keyword">if</span> (!file.exists())</span><br><span class="line">            file.mkdir();</span><br><span class="line">        file = <span class="keyword">new</span> File(file.getPath() + File.separator + <span class="string">"test.xml"</span>);</span><br><span class="line">        <span class="keyword">return</span> file;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 保存数据</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data 需要保存的数据</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cls 数据bean的class对象</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">saveUserData</span><span class="params">(T data, Class&lt;T&gt; cls)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JAXBContext context = JAXBContext.newInstance(cls);</span><br><span class="line">            Marshaller m = context.createMarshaller();</span><br><span class="line">            m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT, <span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Marshalling and saving XML to the file.</span></span><br><span class="line">            m.marshal(data, getSavePath());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> T <span class="title">loadUserData</span><span class="params">(Class&lt;T&gt; cls)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            JAXBContext context = JAXBContext.newInstance(cls);</span><br><span class="line">            Unmarshaller um = context.createUnmarshaller();</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Reading XML from the file and unmarshalling.</span></span><br><span class="line">            <span class="keyword">return</span> (T) um.unmarshal(getSavePath());</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>  保存的本地xml数据：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version="1.0" encoding="UTF-8" standalone="yes"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">saveData</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>1<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Allen<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>2<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Tom<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span>&gt;</span>3<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>Lili<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">saveData</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h1 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h1><h2 id="注解说明"><a href="#注解说明" class="headerlink" title="注解说明"></a>注解说明</h2><p>  首先是三种用于标注<strong>顶级类或枚举</strong>的注解，他们可以配合使用，会被保留到<strong>运行时</strong>。</p>
<ul>
<li><p>@XmlAccessOrder：用于标注<strong>顶级类或包</strong>，会被保留到<strong>运行时</strong>。对java对象映射成的xml元素进行排序。有两个值：</p>
<ol>
<li><p>XmlAccessOrder.UNDEFINED：不排序。此为默认值。</p>
</li>
<li><p>XmlAccessOrder.ALPHABETICAL：按字母顺序排序。</p>
</li>
</ol>
</li>
<li>@XmlAccessorType：用于标注<strong>顶级类或包</strong>，会被保留到<strong>运行时</strong>。控制实体类的哪些属性会被映射到xml。有4种值，默认值为PUBLIC_MEMBER：<ol>
<li>XmlAccessType.PROPERTY：所有有getter/setter的属性。</li>
<li>XmlAccessType.FIELD：所有非静态的、非临时变量，也可以理解为所有非静态成员变量。</li>
<li>XmlAccessType.PUBLIC_MEMBER：所有public的或者有getter/setter的属性。</li>
<li>XmlAccessType.NONE：所有属性都不映射。</li>
</ol>
</li>
<li>@XmlRootElement：用于标注<strong>顶级类或枚举</strong>，会被保留到<strong>运行时</strong>。表示xml的根元素，有name和namespace两个方法，可以自定义xml的根元素名称和命名空间，name默认会使用类名，namespace默认为空。</li>
<li>@XmlType：用于标注<strong>顶级类或枚举</strong>，会被保留到<strong>运行时</strong>。包括name，propOrder等属性，propOrder用于排序，不指定时按@XmlAccessOrder排序。</li>
</ul>
<p>再来看看其他常用注解：</p>
<ul>
<li>@XmlElement：用于标注<strong>属性、方法或者参数</strong>，会被保留到<strong>运行时</strong>。用于将java属性映射为xml节点，可以通过name来修改节点的名称。</li>
<li>@XmlAttribute：用于标注<strong>属性、方法</strong>，会被保留到<strong>运行时</strong>。用于将java属性映射为xml属性。</li>
<li>@XmlTransient：用于标注<strong>属性、方法或类</strong>，会被保留到<strong>运行时</strong>。用于在java映射到xml时忽略此属性，不映射到xml。<h1 id="踩坑"><a href="#踩坑" class="headerlink" title="踩坑"></a>踩坑</h1></li>
<li>上面这段代码在java 6/7/8版本都是运行正常的，但是在java 9版本会报java.lang.NoClassDefFoundError: javax/xml/bind/JAXBException 异常，解决办法请参考<a href="https://stackoverflow.com/questions/43574426/how-to-resolve-java-lang-noclassdeffounderror-javax-xml-bind-jaxbexception-in-j" target="_blank" rel="noopener">这里</a></li>
</ul>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><p><img src="http://upload-images.jianshu.io/upload_images/1215918-ff1cdb573f8a9141.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="java系统属性.png"></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/重走Android路：隐式Intent/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/重走Android路：隐式Intent/" itemprop="url">重走Android路：隐式Intent</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:43:50+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Android开发工作中，Intent是我们经常需要打交道的一个类，我们可以用它来启动Activity、Service和Boardcast，Intent有七大属性：</p>
<ul>
<li>ComponentName</li>
<li>Action</li>
<li>Category</li>
<li>Data</li>
<li>Type</li>
<li>Extra</li>
<li>Flags</li>
</ul>
<p>根据是否指定componentName，可以将Intent分为显式Intent和隐式Intent，大多数情况下我们使用的都是它的显式用法，在这里对其隐式用法做个整理并记录。<br>隐式Intent并不会明确指明我们的意图，而是指定了一系列action和category等信息，然后由系统帮我们过滤选出合适的活动去启动，可以用于不同应用程序之间，一般用来启动系统自带的Activity或Service组件。比如调用手机浏览器打开一个网页：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line"><span class="comment">//显示Intent</span></span><br><span class="line"><span class="comment">//intent.setClass(this,SecondActivity.class);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//隐式Intent</span></span><br><span class="line">intent.setAction(Intent.ACTION_VIEW);</span><br><span class="line">intent.setData(Uri.parse(<span class="string">"http://www.jianshu.com/"</span>));</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-30b7447eff219add.gif?imageMogr2/auto-orient/strip" alt="隐式Intent.gif"></p>
<h1 id="属性详解"><a href="#属性详解" class="headerlink" title="属性详解"></a>属性详解</h1><h2 id="ComponentName"><a href="#ComponentName" class="headerlink" title="ComponentName"></a>ComponentName</h2><p>表示要启动的组件的名称。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">intent.setClass(<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line"><span class="comment">//Intent intent = new Intent(this,SecondActivity.class);</span></span><br><span class="line"></span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure></p>
<p>这是一段很常见的代码，代表Intent的显式用法，等同于<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ComponentName componentName = <span class="keyword">new</span> ComponentName(<span class="keyword">this</span>,SecondActivity.class);</span><br><span class="line">intent.setComponent(componentName);</span><br></pre></td></tr></table></figure></p>
<p>其实两种写法是一样的，打开源码一看便知，第一种写法的内部实现就是第二种写法。</p>
<h2 id="Action"><a href="#Action" class="headerlink" title="Action"></a>Action</h2><p>action为自定义的一个字符串，用来让系统过滤我们的意图，一般和category、intent-filter搭配使用，category至少有一个，可以多个。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//AndroidManifest中注册时</span></span><br><span class="line">&lt;activity android:name=<span class="string">".SecondActivity"</span>&gt;</span><br><span class="line">    &lt;intent-filter&gt;</span><br><span class="line">        &lt;action android:name=<span class="string">"action.test"</span>/&gt;</span><br><span class="line">        &lt;category android:name=<span class="string">"android.intent.category.DEFAULT"</span> /&gt;</span><br><span class="line">    &lt;/intent-filter&gt;</span><br><span class="line">&lt;/activity&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">//代码中调用，category为 默认的default，故不用指定</span></span><br><span class="line">Intent intent = <span class="keyword">new</span> Intent();</span><br><span class="line">intent.setAction(<span class="string">"action.test"</span>);</span><br><span class="line">startActivity(intent);</span><br></pre></td></tr></table></figure></p>
<p><strong>系统自带的Action</strong></p>
<ul>
<li>ACTION_MAIN：(android.intent.action.MAIN)Android程序入口。<br>每个Android应用至少包含一个此类型的Action声明。如果设置多个，则哪个在前，执行哪个。</li>
<li>ACTION_VIEW： (android.intent.action.VIEW)显示指定数据。<br>例如上面的调用浏览器打开网页，同理根据数据的不同可以打开地图、发送短信、打开多媒体等等。</li>
<li>ACTION_EDIT： (android.intent.action.EDIT)编辑指定数据。</li>
<li>ACTION_DIAL： (android.intent.action.DIAL)显示拨号面板。</li>
<li>ACTION_CALL： (android.intent.action.CALL)直接呼叫Data中所带的号码。</li>
<li>ACTION_ANSWER： (android.intent.action.ANSWER)接听来电。</li>
<li>ACTION_SEND： (android.intent.action.SEND)向其他人发送数据(例如：彩信/email)。</li>
<li>ACTION_SENDTO： (android.intent.action.SENDTO)向其他人发送短信。</li>
<li>ACTION_SEARCH： (android.intent.action.SEARCH)执行搜索。</li>
<li>ACTION_GET_CONTENT： (android.intent.action.GET_CONTENT)让用户选择数据，并返回所选数据。<h2 id="Category"><a href="#Category" class="headerlink" title="Category"></a>Category</h2>category是action的额外附加的类别信息。</li>
</ul>
<p><strong>常用Category属性常量</strong></p>
<ul>
<li>CATEGORY_DEFAULT： (android.intent.category.DEFAULT)Android系统中默认的执行方式，按照普通Activity的执行方式执行。</li>
<li>CATEGORY_HOME： (android.intent.category.HOME)设置该组件为Home Activity，将是设备启动后第一个显示的界面。</li>
<li>CATEGORY_LAUNCHER： (android.intent.category.LAUNCHER)设置该组件为在当前应用程序启动器中优先级最高的Activity，通常与入口ACTION_MAIN配合使用。</li>
<li>CATEGORY_BROWSABLE： (android.intent.category.BROWSABLE)设置该组件可以使用<a href="https://www.2cto.com/os/liulanqi/" target="_blank" rel="noopener">浏览器</a>启动。</li>
</ul>
<h2 id="Data属性："><a href="#Data属性：" class="headerlink" title="Data属性："></a>Data属性：</h2><p>　　Data属性通常用于向Action属性提供操作的数据。Data属性的值是个Uri对象。<br>Uri的格式如下：scheme:// host:port/path</p>
<p><strong>系统内置的几个Data属性常量：</strong></p>
<ul>
<li>tel://：号码数据格式，后跟电话号码。</li>
<li>mailto://：邮件数据格式，后跟邮件收件人地址。</li>
<li>smsto://：短息数据格式，后跟短信接收号码。</li>
<li>content://：内容数据格式，后跟需要读取的内容。</li>
<li>file://：文件数据格式，后跟文件路径。</li>
<li>market:// search?q=pname:pkgname：市场数据格式，在Google Market里搜索包名为pkgname的应用。</li>
<li>geo:// latitude, longitude：经纬数据格式，在地图上显示经纬度所指定的位置。<h2 id="Type属性"><a href="#Type属性" class="headerlink" title="Type属性"></a>Type属性</h2>　　设置MIME data类型（需小写，或者使用setTypeAndNormalize），主要是对data属性的一个说明，但通常情况下data和type有一个便可以了。<br><a href="http://www.w3school.com.cn/media/media_mimeref.asp" target="_blank" rel="noopener">MIME type</a><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Intent源码</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Intent <span class="title">setData</span><span class="params">(Uri data)</span> </span>&#123;</span><br><span class="line">        mData = data;</span><br><span class="line">        mType = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> Intent <span class="title">setType</span><span class="params">(String type)</span> </span>&#123;</span><br><span class="line">        mData = <span class="keyword">null</span>;</span><br><span class="line">        mType = type;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//如果想同时设置data和type，可以调用此方法。</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Intent <span class="title">setDataAndType</span><span class="params">(Uri data, String type)</span> </span>&#123;</span><br><span class="line">        mData = data;</span><br><span class="line">        mType = type;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Extra属性"><a href="#Extra属性" class="headerlink" title="Extra属性"></a>Extra属性</h2><p>　　一般用于数据传递。日常开发中经常使用，不再赘述。值得一提的是系统同样内置了一些key，可以用来携带短信内容等。</p>
<h2 id="Flags属性"><a href="#Flags属性" class="headerlink" title="Flags属性"></a>Flags属性</h2><p>　　可以通过设置flags来控制Intent是怎么被处理的，所有的FLAG<em>ACTIVITY</em><em> 格式的flag都服务于context.startActivity()；所有FLAG<em>RECEIVER</em></em> 格式的flag都服务于context.sendBroadcast()。<br>日常开发中通常用来表示Activity的启动模式：</p>
<ul>
<li>Intent.FLAG_ACTIVITY_CLEAR_TASK：在目标Activity启动之前，清除栈内的所有activity，该目标activity成为另一个栈的栈底，只能和FLAG_ACTIVITY_NEW_TASK联合使用。</li>
<li>Intent.FLAG_ACTIVITY_CLEAR_TOP：如果栈内存在该activity的实例，则清除该实例上面的所有activity，使该实例位于栈顶。</li>
<li>Intent.FLAG_ACTIVITY_NEW_TASK：另起一个activity栈。</li>
<li>Intent.FLAG_ACTIVITY_SINGLE_TOP：如果栈内存在该activity的实例，且位于栈顶，则直接使用该实例，不重新创建。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/Kotlin学习笔记（二）集合/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/Kotlin学习笔记（二）集合/" itemprop="url">Kotlin学习笔记（二）集合</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:40:56+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本来这节不应该放这里的，因为在公司做一个小项目练手的时候碰到了些坑，使用了一个List，结果怎么也找不到添加item的方法，就先恶补了一下。<br>　　首先Kotlin中的集合具有可变性和不可变性的区别，来看一下Kotlin中的相关接口：</p>
<table>
<thead>
<tr>
<th>Iterable</th>
<th>MutableIterable</th>
</tr>
</thead>
<tbody>
<tr>
<td>Collection</td>
<td>MutableCollection</td>
</tr>
<tr>
<td>List</td>
<td>MutableList</td>
</tr>
<tr>
<td>Set</td>
<td>MutableSet</td>
</tr>
<tr>
<td>Map</td>
<td>MutableMap</td>
</tr>
</tbody>
</table>
<p>　　首先说明一下，这个表格并不代表继承关系，只是区分可变不可变。继承关系如下图，原谅我画的比较丑：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-8243b7045c733881.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Kotlin集合继承关系.jpg"></p>
<ul>
<li>Iterable：父类。所有可以遍历的集合都是实现这个接口。只声明了iterator()一个方法，返回一个Iterator。</li>
<li>MutableIterable：重写了父类的iterator()方法，返回一个MutableIterable。</li>
<li>Collection：这个类是一个范性集合。仅包含集合是否为空，是否包含某元素等几个方法，有兴趣的可以看源码，是只读集合，不可变。</li>
<li>MutableCollection：在Collection的基础上提供了额外的函数，比如 add 、 remove 、 clear 等等，是可变集合。</li>
<li>List：它是一个范性有序的集合。因为它的有序，我们可以使用 get 函数通过position来访问，继承于Collection，只读集合。</li>
<li>MutableList：一个支持增加和删除item的List，可变集合。</li>
<li>Set：一个无序并不支持重复item的集合。</li>
<li>MutableSet：一个支持增加和删除item的Set。</li>
<li>Map：一个key-value对的集合。key在map中是唯一的，也就是说不能有两对key是一样的键值对存在于一个map中。</li>
<li>MutableMap：一个支持增加和删除item的map。增加了put和remove方法。<br>　　附上源码中的结构图：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-c139e4564b8758aa.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-75781df9a81b33ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-9e63a310e2e4d205.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="3.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-1a1cd1a9e2f6d0d8.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="4.png"></p>
<p>　　另外，kotlin中封装了很多常用的操作符，学会使用的话可以节省我们很多的代码量。</p>
<h4 id="总数操作符"><a href="#总数操作符" class="headerlink" title="总数操作符"></a>总数操作符</h4><p><strong>any</strong><br>如果至少有一个元素符合给出的判断条件，则返回true。<br><strong>all</strong><br>如果全部的元素符合给出的判断条件，则返回true。<br><strong>count</strong><br>返回符合给出判断条件的元素总数。<br><strong>fold</strong><br>在一个初始值的基础上从第一项到最后一项通过一个函数累计所有的元素。<br><strong>foldRight</strong><br>与 fold 一样，但是顺序是从最后一项到第一项。<br><strong>forEach</strong><br>遍历所有元素，并执行给定的操作。<br><strong>forEachIndexed</strong><br>与 forEach 类似，但是我们同时可以得到元素的index。类似的还有foldIndexed和foldRightIndexed。<br><strong>max</strong><br>返回最大的一项，如果没有则返回null。min同理。<br><strong>maxBy</strong><br>根据给定的函数返回最大的一项（返回的是集合本身的元素，而非给定函数运算过结果），如果没有则返回null。minBy同理。<br><strong>none</strong><br>如果没有任何元素与给定的函数匹配，则返回true。<br><strong>reduce</strong><br>reduce系列类似fold系列，包括reduceIndexed、reduceRight、reduceRightIndexed，只是没有初始值。<br><strong>sumBy</strong><br>返回所有每一项通过函数转换之后的数据的总和。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">println(list.any &#123; it &gt; <span class="number">5</span> &#125;)<span class="comment">//true</span></span><br><span class="line">println(list.all &#123; it &gt; <span class="number">1</span> &#125;)<span class="comment">//false</span></span><br><span class="line">println(list.count &#123; it &gt; <span class="number">3</span> &#125;)<span class="comment">//3</span></span><br><span class="line">println(list.fold(<span class="number">5</span>) &#123; total, next -&gt; total + next &#125;)<span class="comment">//5+1+2+3+4+5+6=26</span></span><br><span class="line">println(list.fold(<span class="number">5</span>) &#123; total, next -&gt; total * next &#125;)<span class="comment">//5*1*2*3*4*5*6=3600</span></span><br><span class="line">println(list.fold(<span class="string">"5"</span>) &#123; total, next -&gt; total + next &#125;)<span class="comment">//"5"+1+2+3+4+5+6="5123456"</span></span><br><span class="line">println(list.foldRight(<span class="number">5</span>) &#123; total, next -&gt; total + next &#125;)<span class="comment">//"5"+1+2+3+4+5+6="5123456"</span></span><br><span class="line">list.forEach &#123; print(it) &#125;<span class="comment">//123456</span></span><br><span class="line">list.forEachIndexed &#123; index, i -&gt; print(<span class="string">"<span class="variable">$index</span>:<span class="variable">$i</span>,"</span>) &#125;<span class="comment">//0:1,1:2,2:3,3:4,4:5,5:6,</span></span><br><span class="line">println(list.max())<span class="comment">//6</span></span><br><span class="line">println(list.maxBy &#123; it * <span class="number">-1</span> &#125;)<span class="comment">//1</span></span><br><span class="line">println(list.none &#123; it &gt; <span class="number">6</span> &#125;)<span class="comment">//true</span></span><br><span class="line">println(list.reduce &#123; acc, i -&gt; acc + i &#125;)<span class="comment">//21</span></span><br><span class="line">println(list.sumBy &#123; it * <span class="number">-1</span> &#125;)<span class="comment">//-21</span></span><br></pre></td></tr></table></figure></p>
<h4 id="过滤操作符"><a href="#过滤操作符" class="headerlink" title="过滤操作符"></a>过滤操作符</h4><p><strong>drop</strong><br>返回去掉前n个元素的剩余元素的列表。<br><strong>dropLast</strong><br>返回去掉后n个元素的剩余元素的列表。<br><strong>dropWhile</strong><br>返回根据给定函数从第一项开始去掉指定元素的列表。即从前面开始，符合条件的一律去除，直到碰到一个不符合条件的元素为止。<br><strong>dropLastWhile</strong><br>返回根据给定函数从最后一项开始去掉指定元素的列表。<br><strong>filter</strong><br>过滤所有符合给定函数条件的元素。filterIndexed同filter，同时返回索引。<br><strong>filterNot</strong><br>过滤所有不符合给定函数条件的元素。<br><strong>filterNotNull</strong><br>过滤所有元素中不是null的元素。<br><strong>slice</strong><br>过滤一个list中指定index的元素。<br><strong>take</strong><br>返回从第一个开始的n个元素。takeLast从最后一个开始返回n个。<br><strong>takeWhile</strong><br>返回从第一个开始符合给定函数条件的元素，一旦不符合即停止。takeLastWhile从最后一个开始返回。<br><strong>takeIf</strong><br>如果满足条件，则返回这个集合，注意参数it代表的是集合，而非集合中的元素。takeUnless相反，如果满足条件，则返回null，否则返回集合本身。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">println(list.drop(<span class="number">2</span>))<span class="comment">//[3, 4, 5, 6]</span></span><br><span class="line">println(list.dropLast(<span class="number">2</span>))<span class="comment">//[1, 2, 3, 4]</span></span><br><span class="line">println(list.dropWhile &#123; it &gt; <span class="number">2</span> &#125;)<span class="comment">//[1, 2, 3, 4, 5, 6]</span></span><br><span class="line">println(list.dropLastWhile &#123; it &gt; <span class="number">2</span> &#125;)<span class="comment">//[1, 2]</span></span><br><span class="line">println(list.filter &#123; it &gt; <span class="number">3</span> &#125;)<span class="comment">//[4, 5, 6]</span></span><br><span class="line">println(list.filterIndexed &#123; index, i -&gt; i &gt; <span class="number">3</span> &amp;&amp; index &gt; <span class="number">4</span> &#125;)<span class="comment">//[6]</span></span><br><span class="line">println(list.filterNot &#123; it &gt; <span class="number">3</span> &#125;)<span class="comment">//[1, 2, 3]</span></span><br><span class="line">println(list.filterNotNull())<span class="comment">//[1, 2, 3, 4, 5, 6]</span></span><br><span class="line">println(list.slice(<span class="number">1.</span><span class="number">.2</span>))<span class="comment">//[2, 3]</span></span><br><span class="line">println(list.take(<span class="number">3</span>))<span class="comment">//[1, 2, 3]</span></span><br><span class="line">println(list.takeLast(<span class="number">3</span>))<span class="comment">//[4, 5, 6]</span></span><br><span class="line">println(list.takeWhile &#123; it &gt; <span class="number">3</span> &#125;)<span class="comment">//[]</span></span><br><span class="line">println(list.takeLastWhile &#123; it &gt; <span class="number">3</span> &#125;)<span class="comment">//[4, 5, 6]</span></span><br><span class="line">println(list.takeIf &#123; it.isNotEmpty() &#125;)<span class="comment">//[1, 2, 3, 4, 5, 6]</span></span><br><span class="line">println(list.takeUnless &#123; it.isNotEmpty() &#125;)<span class="comment">//null</span></span><br></pre></td></tr></table></figure></p>
<h4 id="映射操作符"><a href="#映射操作符" class="headerlink" title="映射操作符"></a>映射操作符</h4><p><strong>flatMap</strong><br>遍历所有的元素，为每一个创建一个集合，最后把所有的集合放在一个集合中。<br><strong>groupBy</strong><br>返回一个根据给定函数分组后的map。<br><strong>map</strong><br>返回一个每一个元素根据给定的函数转换所组成的List。mapIndexed同理，同时可以操作每一个元素的索引。<br><strong>mapNotNull</strong><br>返回一个每一个非null元素根据给定的函数转换所组成的List。mapIndexedNotNull同理。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">println(list.flatMap &#123; listOf(it + <span class="number">1</span>) &#125;)<span class="comment">//[2, 3, 4, 5, 6, 7]</span></span><br><span class="line">println(list.groupBy &#123; it % <span class="number">2</span> == <span class="number">0</span> &#125;)<span class="comment">//&#123;false=[1, 3, 5], true=[2, 4, 6]&#125;</span></span><br><span class="line">println(list.map &#123; it * it &#125;)<span class="comment">//[1, 4, 9, 16, 25, 36]</span></span><br><span class="line">println(list.mapNotNull &#123; it?.times(<span class="number">2</span>) &#125;)<span class="comment">//[2, 4, 6, 8, 10, 12],如果list改为listOf(1, 2, 3, 4, 5, null)，则返回[2, 4, 6, 8, 10]</span></span><br></pre></td></tr></table></figure></p>
<h4 id="元素操作符"><a href="#元素操作符" class="headerlink" title="元素操作符"></a>元素操作符</h4><p><strong>contains</strong><br>如果指定元素可以在集合中找到，则返回true。<br><strong>elementAt</strong><br>返回给定index对应的元素，如果index数组越界则会抛出 IndexOutOfBoundsException 。<br><strong>elementAtOrElse</strong><br>返回给定index对应的元素，如果index数组越界则会根据给定函数返回默认值。<br><strong>elementAtOrNull</strong><br>返回给定index对应的元素，如果index数组越界则会返回null。<br><strong>first</strong><br>返回符合给定函数条件的第一个元素。<br><strong>firstOrNull</strong><br>返回符合给定函数条件的第一个元素，如果没有符合则返回null。<br><strong>indexOf</strong><br>返回指定元素的第一个index，如果不存在，则返回 -1 。<br><strong>indexOfFirst</strong><br>返回第一个符合给定函数条件的元素的index，如果没有符合则返回 -1 。<br><strong>indexOfLast</strong><br>返回最后一个符合给定函数条件的元素的index，如果没有符合则返回 -1 。<br><strong>last</strong><br>返回符合给定函数条件的最后一个元素。<br><strong>lastIndexOf</strong><br>返回指定元素的最后一个index，如果不存在，则返回 -1 。<br><strong>lastOrNull</strong><br>返回符合给定函数条件的最后一个元素，如果没有符合则返回null。<br><strong>single</strong><br>返回符合给定函数的单个元素，如果没有符合或者超过一个，则抛出异常。<br><strong>singleOrNull</strong><br>返回符合给定函数的单个元素，如果没有符合或者超过一个，则返回null。<br>　　这一部分与java中的集合操作类似，基本看字面就可以理解什么意思，应该也是最常用的一些操作符了。</p>
<h4 id="生产操作符"><a href="#生产操作符" class="headerlink" title="生产操作符"></a>生产操作符</h4><p><strong>partition</strong><br>把一个给定的集合分割成两个，第一个集合是由原集合每一项元素匹配给定函数条件返回 true 的元素组成，第二个集合是由原集合每一项元素匹配给定函数条件返回 false 的元素组成。<br><strong>plus</strong><br>返回一个包含原集合和给定集合中所有元素的集合，因为函数的名字原因，我们可以使用 + 操作符。<br><strong>zip</strong><br>返回由 pair 组成的List，每个 pair 由两个集合中相同index的元素组成。这个返回的List的大小由最小的那个集合决定。<br><strong>unzip</strong><br>从包含pair的List中生成包含List的Pair。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list1 = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line"><span class="keyword">val</span> list2 = listOf(<span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">println(list1.partition &#123; it % <span class="number">2</span> == <span class="number">0</span> &#125;)<span class="comment">//([2], [1, 3])</span></span><br><span class="line">println(list1.plus(list2))<span class="comment">//[1, 2, 3, 4, 5, 6]</span></span><br><span class="line">println(list1 + list2)<span class="comment">//[1, 2, 3, 4, 5, 6]</span></span><br><span class="line">println(list1.zip(list2))<span class="comment">//[(1, 4), (2, 5), (3, 6)]</span></span><br><span class="line">println(listOf(Pair(<span class="number">1</span>, <span class="number">2</span>), Pair(<span class="number">3</span>, <span class="number">4</span>)).unzip())<span class="comment">//([1, 3], [2, 4])</span></span><br></pre></td></tr></table></figure></p>
<h4 id="顺序操作符"><a href="#顺序操作符" class="headerlink" title="顺序操作符"></a>顺序操作符</h4><p><strong>reverse</strong><br>返回一个与原list反序的list。<br><strong>sort</strong><br>返回一个原list升序排列后的list。<br><strong>sortBy</strong><br>返回一个根据指定函数升序排序后的list。<br><strong>sortDescending</strong><br>返回一个原list降序排序后的List。<br><strong>sortDescendingBy</strong><br>返回一个根据指定函数降序排序后的list。<br><figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> list = listOf(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>)</span><br><span class="line">println(list.reversed())<span class="comment">//[6, 5, 4, 3, 2, 1]</span></span><br><span class="line">println(list.sorted())<span class="comment">//[1, 2, 3, 4, 5, 6]</span></span><br><span class="line">println(list.sortedBy &#123; it % <span class="number">6</span> &#125;)<span class="comment">//[6, 1, 2, 3, 4, 5]</span></span><br><span class="line">println(list.sortedDescending())<span class="comment">//[6, 5, 4, 3, 2, 1]</span></span><br><span class="line">println(list.sortedByDescending &#123; it % <span class="number">6</span> &#125;)<span class="comment">//[5, 4, 3, 2, 1, 6]</span></span><br></pre></td></tr></table></figure></p>
<p>　　注意上述所有操作符的测试环境为List，而非MutableList，即上述操作符并不会改变原集合本身。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/Kotlin学习笔记（一）初识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/Kotlin学习笔记（一）初识/" itemprop="url">Kotlin学习笔记（一）初识</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:40:12+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>最近google官方宣布支持Kotlin作为android开发的一门新语言，凭自己目前的水平还做不到去评判一门语言，但我相信google官方自有其道理，所以果断去了解了一下，在此记录一下自己的<strong>学习历程</strong>。<br>　　配置方式很简单，AS在3.0之后会默认支持Kotlin，老版本直接装个kotlin插件，然后新建个kt文件，AS会自动帮你进行gradle配置（感谢万能的IDE）。不过，作为一个有理想的少年，还是应该了解一下具体是怎么配置的：<br>　　在工程的gradle中如下配置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">buildscript &#123;</span><br><span class="line">    ext.kotlin_version = <span class="string">'1.1.2-4'</span> <span class="comment">//版本号</span></span><br><span class="line">    repositories &#123;</span><br><span class="line">        maven &#123; url <span class="string">'https://maven.google.com'</span> &#125;</span><br><span class="line">        jcenter()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath <span class="string">'com.android.tools.build:gradle:3.0.0-alpha1'</span></span><br><span class="line">        classpath <span class="string">"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"</span> <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">allprojects &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        jcenter()</span><br><span class="line">        maven &#123; url <span class="string">'https://maven.google.com'</span> &#125;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">task <span class="title">clean</span><span class="params">(type: Delete)</span> </span>&#123;</span><br><span class="line">    delete rootProject.buildDir</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　在module的gradle中加入如下配置：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">apply plugin: <span class="string">'kotlin-android'</span></span><br><span class="line">...</span><br><span class="line">dependencies &#123;</span><br><span class="line">    ...</span><br><span class="line">    compile <span class="string">"org.jetbrains.kotlin:kotlin-stdlib-jre7:$kotlin_version"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h1 id="粗略浏览"><a href="#粗略浏览" class="headerlink" title="粗略浏览"></a>粗略浏览</h1><p>　　首先新建一个简单的Activity，仅仅是一个按钮，点击弹出一个Toast，通过AS一键转化为Kotlin，对比一下不同之处：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//java</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">AppCompatActivity</span> <span class="keyword">implements</span> <span class="title">View</span>.<span class="title">OnClickListener</span></span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Button btnToast;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        initViews();</span><br><span class="line">        events();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">initViews</span><span class="params">()</span></span>&#123;</span><br><span class="line">        btnToast = (Button)findViewById(R.id.btn_toast);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">events</span><span class="params">()</span></span>&#123;</span><br><span class="line">        btnToast.setOnClickListener(<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (v.getId() == R.id.btn_toast)&#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>,<span class="string">"from java"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//kotlin</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> : <span class="type">AppCompatActivity</span></span>(), View.OnClickListener &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> btnToast: Button? = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onCreate</span><span class="params">(savedInstanceState: <span class="type">Bundle</span>?)</span></span> &#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState)</span><br><span class="line">        setContentView(R.layout.activity_main)</span><br><span class="line"></span><br><span class="line">        initViews()</span><br><span class="line">        events()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">initViews</span><span class="params">()</span></span> &#123;</span><br><span class="line">        btnToast = findViewById(R.id.btn_toast) <span class="keyword">as</span> Button</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">fun</span> <span class="title">events</span><span class="params">()</span></span> &#123;</span><br><span class="line">        btnToast!!.setOnClickListener(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">fun</span> <span class="title">onClick</span><span class="params">(v: <span class="type">View</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (v.id === R.id.btn_toast) &#123;</span><br><span class="line">            Toast.makeText(<span class="keyword">this</span>, <span class="string">"from java"</span>, Toast.LENGTH_SHORT).show()</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　简单总结一下：</p>
<ul>
<li>class关键字前没有public，因为是AS一键转的，猜测Kotlin类是默认public的。</li>
<li>继承用单冒号（：）来表示，如果同时有多个接口，依次用逗号隔开。</li>
<li>声明属性的方式改变。</li>
<li>声明方法和传参方式改变。</li>
<li>语句结尾不需要加分号。</li>
<li>as表示类型转换。<br>　　暂时就看出这么多，虽然看着改变了很多东西，但还是基本可以看懂的，说明kotlin对有java基础的我们来说还是很友好的，kotlin官方也确实说明了可以和java进行100%转化，但更简洁、安全。<br>　　今天的内容很少，主要就是对kotlin有一个粗略的印象，下篇正式开始自己的kotlin入坑之旅。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/自定义登陆动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/自定义登陆动画/" itemprop="url">自定义登陆动画</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:37:57+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p><img src="http://upload-images.jianshu.io/upload_images/1215918-7b0c3942c7b8879b.gif?imageMogr2/auto-orient/strip" alt="loading.gif"></p>
<p>　　一个自用的登陆动画，可以自定义背景颜色、文本、选中颜色、动画时间等。需要android21以上版本。</p>
<h1 id="实现步骤"><a href="#实现步骤" class="headerlink" title="实现步骤"></a>实现步骤</h1><h2 id="自定义登陆按钮"><a href="#自定义登陆按钮" class="headerlink" title="自定义登陆按钮"></a>自定义登陆按钮</h2><p>　　登陆按钮的绘制主要有以下几点：</p>
<ul>
<li><strong>绘制按钮的静态背景及文本</strong>：这个没什么好说的，就是canvas的使用。</li>
<li><strong>按钮的焦点状态</strong>：通过onFocusChanged方法来判断按钮是否获得焦点，不再tv上使用可以无视这个。</li>
<li><strong>按钮的缩短动画</strong>：通过属性动画（值动画）获取一个不断改变的状态值，同时不断刷新view实现动画效果。</li>
<li><strong>按钮的旋转动画</strong>：就是一个普通的旋转补间动画RotateAnimation。</li>
<li><strong>登陆失败时的回置动画</strong>：同缩短动画。</li>
</ul>
<p>　　文笔比较渣，还是直接看代码吧，比较简单，也加了注解。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginButton</span> <span class="keyword">extends</span> <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">int</span> duration = <span class="number">300</span>;<span class="comment">//按钮缩短动画的持续时间</span></span><br><span class="line">    <span class="keyword">private</span> Paint paintBg;</span><br><span class="line">    <span class="keyword">private</span> Paint paintText;</span><br><span class="line">    <span class="keyword">private</span> Paint paintCircle;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> startWidth;<span class="comment">//初始宽度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> startHeight;<span class="comment">//初始高度</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> marginLength;<span class="comment">//缩进距离</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> drawCircle = <span class="keyword">false</span>;<span class="comment">//绘制圆还是文本</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> bgColor;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> bgColorFocused;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> textColor;</span><br><span class="line">    <span class="keyword">private</span> String text;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> textSize;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> textWidth;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> textHeight;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Loading loading;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setLoading</span><span class="params">(Loading loading)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.loading = loading;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginButton</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">LoginButton</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">		<span class="comment">//自定义属性</span></span><br><span class="line">        TypedArray array = context.obtainStyledAttributes(attrs, R.styleable.LoginButton);</span><br><span class="line"></span><br><span class="line">        bgColor = array.getColor(R.styleable.LoginButton_bgColor, Color.RED);</span><br><span class="line">        bgColorFocused = array.getColor(R.styleable.LoginButton_bgColorFocused, <span class="number">0</span>);</span><br><span class="line">        textColor = array.getColor(R.styleable.LoginButton_textColor, Color.WHITE);</span><br><span class="line">        text = array.getString(R.styleable.LoginButton_text);</span><br><span class="line">        textSize = array.getDimensionPixelSize(R.styleable.LoginButton_textSize, <span class="number">24</span>);</span><br><span class="line"></span><br><span class="line">        array.recycle();</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//设置按钮可点击，可获得焦点</span></span><br><span class="line">        setClickable(<span class="keyword">true</span>);</span><br><span class="line">        setFocusable(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line">        paintBg = <span class="keyword">new</span> Paint();</span><br><span class="line">        paintBg.setColor(bgColor);</span><br><span class="line">        paintBg.setStyle(Paint.Style.FILL);</span><br><span class="line">        paintBg.setAntiAlias(<span class="keyword">true</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        paintText = <span class="keyword">new</span> Paint();</span><br><span class="line">        paintText.setColor(textColor);</span><br><span class="line">        paintText.setTextSize(textSize);</span><br><span class="line">        Rect rect = <span class="keyword">new</span> Rect();</span><br><span class="line">        paintText.getTextBounds(text, <span class="number">0</span>, text.length(), rect);</span><br><span class="line">        textWidth = rect.width();</span><br><span class="line">        textHeight = rect.height();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        paintCircle = <span class="keyword">new</span> Paint();</span><br><span class="line">        paintCircle.setColor(textColor);</span><br><span class="line">        paintCircle.setStrokeWidth(<span class="number">3</span>);</span><br><span class="line">        paintCircle.setStyle(Paint.Style.STROKE);</span><br><span class="line">        paintCircle.setAntiAlias(<span class="keyword">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onWindowFocusChanged</span><span class="params">(<span class="keyword">boolean</span> hasWindowFocus)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onWindowFocusChanged(hasWindowFocus);</span><br><span class="line">        <span class="keyword">if</span> (hasWindowFocus) &#123;</span><br><span class="line">            startWidth = getMeasuredWidth();</span><br><span class="line">            startHeight = getMeasuredHeight();</span><br><span class="line">            invalidate();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果不在tv上使用，可以不加这段</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onFocusChanged</span><span class="params">(<span class="keyword">boolean</span> gainFocus, <span class="keyword">int</span> direction, @Nullable Rect previouslyFocusedRect)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onFocusChanged(gainFocus, direction, previouslyFocusedRect);</span><br><span class="line">        <span class="keyword">if</span> (gainFocus &amp;&amp; bgColorFocused != <span class="number">0</span>)</span><br><span class="line">            paintBg.setColor(bgColorFocused);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            paintBg.setColor(bgColor);</span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onDraw</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDraw(canvas);</span><br><span class="line">        drawBg(canvas);</span><br><span class="line">        <span class="keyword">if</span> (drawCircle)</span><br><span class="line">            drawCircle(canvas);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            drawText(canvas);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绘制圆，动画</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawCircle</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        RectF oval = <span class="keyword">new</span> RectF();</span><br><span class="line">        oval.left = startWidth / <span class="number">2</span> - startHeight / <span class="number">2</span> + startHeight / <span class="number">5</span>;</span><br><span class="line">        oval.right = oval.left + startHeight / <span class="number">5</span> * <span class="number">3</span>;</span><br><span class="line">        oval.top = startHeight / <span class="number">5</span>;</span><br><span class="line">        oval.bottom = oval.top + startHeight / <span class="number">5</span> * <span class="number">3</span>;</span><br><span class="line">        canvas.drawArc(oval, <span class="number">0</span>, <span class="number">120</span>, <span class="keyword">false</span>, paintCircle);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绘制文本</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawText</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        canvas.drawText(text, startWidth / <span class="number">2</span> - textWidth / <span class="number">2</span>, startHeight / <span class="number">2</span> + textHeight / <span class="number">2</span>, paintText);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//绘制背景</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">drawBg</span><span class="params">(Canvas canvas)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = marginLength;</span><br><span class="line">        <span class="keyword">int</span> top = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> right = startWidth - marginLength;</span><br><span class="line">        <span class="keyword">int</span> bottom = startHeight;</span><br><span class="line">        RectF rectF = <span class="keyword">new</span> RectF(left, top, right, bottom);</span><br><span class="line">        <span class="comment">//绘制圆角矩形  1.范围  2.x方向的圆角半径  3.y方向的圆角半径  4.画笔</span></span><br><span class="line">        canvas.drawRoundRect(rectF, startHeight / <span class="number">2</span>, startHeight / <span class="number">2</span>, paintBg);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 点击按钮后启动动画</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">click</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        setClickable(<span class="keyword">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> scale = startHeight / (<span class="keyword">float</span>) startWidth;</span><br><span class="line">        ValueAnimator animator = ValueAnimator.ofFloat(<span class="number">1</span>, scale);</span><br><span class="line">        animator.setDuration(duration);</span><br><span class="line">        animator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">float</span> flag = (<span class="keyword">float</span>) animation.getAnimatedValue();</span><br><span class="line">                marginLength = (<span class="keyword">int</span>) (startWidth * (<span class="number">1</span> - flag)) / <span class="number">2</span>;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ((startWidth - marginLength * <span class="number">2</span>) &lt; textWidth * <span class="number">1.5</span>)</span><br><span class="line">                    drawCircle = <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">                invalidate();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        animator.addListener(<span class="keyword">new</span> Animator.AnimatorListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                startCircleAnim();</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (loading != <span class="keyword">null</span>)</span><br><span class="line">                    loading.startLoading();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        animator.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 登陆失败后回置</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reset</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        clearAnimation();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">float</span> scale = startHeight / (<span class="keyword">float</span>) startWidth;</span><br><span class="line">        ValueAnimator animator = ValueAnimator.ofFloat(scale, <span class="number">1</span>);</span><br><span class="line">        animator.setDuration(duration);</span><br><span class="line">        animator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>&#123;</span><br><span class="line">                <span class="keyword">float</span> flag = (<span class="keyword">float</span>) animation.getAnimatedValue();</span><br><span class="line">                marginLength = (<span class="keyword">int</span>) (startWidth * (<span class="number">1</span> - flag)) / <span class="number">2</span>;</span><br><span class="line">                invalidate();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        animator.addListener(<span class="keyword">new</span> Animator.AnimatorListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line">                drawCircle = <span class="keyword">false</span>;</span><br><span class="line">                invalidate();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line">                setClickable(<span class="keyword">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        animator.start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//开始按钮的旋转动画，表示加载中</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">startCircleAnim</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        RotateAnimation ra = <span class="keyword">new</span> RotateAnimation(<span class="number">0</span>, <span class="number">360</span>, Animation.RELATIVE_TO_SELF, <span class="number">0.5f</span>, Animation.RELATIVE_TO_SELF, <span class="number">0.5f</span>);</span><br><span class="line">        ra.setDuration(duration * <span class="number">2</span>);</span><br><span class="line">        ra.setInterpolator(<span class="keyword">new</span> LinearInterpolator());</span><br><span class="line">        ra.setRepeatCount(-<span class="number">1</span>);</span><br><span class="line">        ra.setFillAfter(<span class="keyword">true</span>);</span><br><span class="line">        startAnimation(ra);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Loading</span> </span>&#123;</span><br><span class="line">        <span class="comment">//添加我们自己的逻辑</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">startLoading</span><span class="params">()</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="调用"><a href="#调用" class="headerlink" title="调用"></a>调用</h2><p>　　如果要使用揭露动画展示下一个界面的话，可以把该按钮在屏幕中的位置信息传递过去，以此作为目标界面揭露动画的起点。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">&lt;lxf.widget.LoginButton</span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"45dp"</span></span><br><span class="line">            android:layout_marginTop=<span class="string">"20dp"</span></span><br><span class="line">            android:onClick=<span class="string">"login"</span></span><br><span class="line">            app:bgColor=<span class="string">"@color/btn_normal"</span></span><br><span class="line">            app:bgColorFocused=<span class="string">"@color/btn_focused"</span></span><br><span class="line">            app:text=<span class="string">"登 陆"</span></span><br><span class="line">            app:textColor=<span class="string">"@color/white"</span></span><br><span class="line">            app:textSize=<span class="string">"18sp"</span> /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">login</span><span class="params">(<span class="keyword">final</span> View view)</span> </span>&#123;</span><br><span class="line">        LoginButton lb = (LoginButton) view;</span><br><span class="line">        <span class="keyword">final</span> <span class="keyword">int</span>[] location = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">        lb.getLocationInWindow(location);</span><br><span class="line">        location[<span class="number">0</span>] = location[<span class="number">0</span>] + lb.getWidth() / <span class="number">2</span>;</span><br><span class="line">        location[<span class="number">1</span>] = location[<span class="number">1</span>] + lb.getHeight() / <span class="number">2</span>;</span><br><span class="line">        lb.setLoading(<span class="keyword">new</span> LoginButton.Loading() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startLoading</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                loading(view, location);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        lb.click();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">loading</span><span class="params">(<span class="keyword">final</span> View view, <span class="keyword">final</span> <span class="keyword">int</span>[] location)</span> </span>&#123;</span><br><span class="line">        Observable.timer(<span class="number">1000</span>, TimeUnit.MILLISECONDS)</span><br><span class="line">                .subscribe(<span class="keyword">new</span> Observer&lt;Long&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(Long value)</span> </span>&#123;</span><br><span class="line">                        Intent intent = <span class="keyword">new</span> Intent(view.getContext(), LoginTargetActivity.class);</span><br><span class="line">                        intent.putExtra(<span class="string">"location"</span>, location);</span><br><span class="line">                        view.getContext().startActivity(intent);</span><br><span class="line">                        <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</span><br><span class="line">                            ((Activity) view.getContext()).overridePendingTransition(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                        Toast.makeText(getApplicationContext(),<span class="string">"登录失败"</span>,Toast.LENGTH_SHORT).show();</span><br><span class="line">                        ((LoginButton) view).reset();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        finish();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="使用揭露动画展示第二个页面"><a href="#使用揭露动画展示第二个页面" class="headerlink" title="使用揭露动画展示第二个页面"></a>使用揭露动画展示第二个页面</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_login_target);</span><br><span class="line"></span><br><span class="line">        WindowManager wm = (WindowManager) getApplicationContext().getSystemService(Context.WINDOW_SERVICE);</span><br><span class="line">        DisplayMetrics outMetrics = <span class="keyword">new</span> DisplayMetrics();</span><br><span class="line">        wm.getDefaultDisplay().getMetrics(outMetrics);</span><br><span class="line">        screenW =  outMetrics.widthPixels;</span><br><span class="line">        screenH =  outMetrics.heightPixels;</span><br><span class="line"></span><br><span class="line">        rootView = (LinearLayout) findViewById(R.id.rootView);</span><br><span class="line"></span><br><span class="line">        rootView.post(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                <span class="keyword">if</span> (Build.VERSION.SDK_INT &gt;= Build.VERSION_CODES.LOLLIPOP) &#123;</span><br><span class="line">                    <span class="keyword">int</span>[] location = getIntent().getIntArrayExtra(<span class="string">"location"</span>);</span><br><span class="line">                    Animator animator = ViewAnimationUtils.createCircularReveal(rootView, location[<span class="number">0</span>], location[<span class="number">1</span>], <span class="number">0</span>,</span><br><span class="line">                            (<span class="keyword">float</span>) Math.hypot(Math.max(location[<span class="number">0</span>], screenW - location[<span class="number">0</span>]), Math.max(location[<span class="number">1</span>], screenH - location[<span class="number">1</span>])));</span><br><span class="line">                    animator.addListener(<span class="keyword">new</span> Animator.AnimatorListener() &#123;</span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationStart</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationEnd</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line">                            <span class="comment">//// <span class="doctag">TODO:</span> 业务逻辑</span></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationCancel</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line"></span><br><span class="line">                        <span class="meta">@Override</span></span><br><span class="line">                        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onAnimationRepeat</span><span class="params">(Animator animation)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                    animator.setDuration(<span class="number">500</span>).start();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h1 id="Demo地址"><a href="#Demo地址" class="headerlink" title="Demo地址"></a>Demo地址</h1><p>　　<a href="https://github.com/lunxinfeng/AndroidDemos" target="_blank" rel="noopener">传送门</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/Rxjava2-Retrofit2-IntentService实现app自动更新/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/Rxjava2-Retrofit2-IntentService实现app自动更新/" itemprop="url">Rxjava2+Retrofit2+IntentService实现app自动更新</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:36:43+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="效果图"><a href="#效果图" class="headerlink" title="效果图"></a>效果图</h1><p>　　网速较慢，只录制了最后几秒，效果还是看得出来。</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1215918-293c4e0105d5778b.gif?imageMogr2/auto-orient/strip" alt="appUpdate.gif"></p>
<h1 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h1><p>　　实现app的版本自动更新。</p>
<h1 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h1><p>　　其实Google官方专门提供了一个DownloadManager类来实现app的自动更新功能，因为项目的网络框架用的Retrofit2配合Rxjava2，因此想试一下自己去实现，顺便练练手。<br>　　此处下载大文件，肯定是要放在后台操作，放在服务中比较合适，而这个服务唯一的任务就是下载，因此我们用IntentService，然后在服务中通过发送Notification实现下载进度的实时监控，那么问题来了，下载过程中如何得到当前的下载进度？这个应该就是难点所在了，本来是想在写入数据到文件的时候将写入的长度记录下来，后来意外在网上看到一种更优雅的方式，通过自定义OkHttp网络拦截器的方式来获取到当前已经下载的数据长度，并通过Rxbus发布数据（<a href="http://blog.csdn.net/jdsjlzx/article/details/52144971" target="_blank" rel="noopener">参考链接</a>），在此做个记录。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><h2 id="自定义ResponseBody"><a href="#自定义ResponseBody" class="headerlink" title="自定义ResponseBody"></a>自定义ResponseBody</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 下载文件</span></span><br><span class="line"><span class="comment"> * Created by lxf on 2017/3/3.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileResponseBody</span> <span class="keyword">extends</span> <span class="title">ResponseBody</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Response originalResponse;<span class="comment">//原结果</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FileResponseBody</span><span class="params">(Response originalResponse)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.originalResponse = originalResponse;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回内容类型</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> MediaType <span class="title">contentType</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> originalResponse.body().contentType();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回内容长度，没有则返回-1</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">contentLength</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> originalResponse.body().contentLength();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//返回缓存源，类似于io中的BufferedReader</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> BufferedSource <span class="title">source</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Okio.buffer(<span class="keyword">new</span> ForwardingSource(originalResponse.body().source()) &#123;</span><br><span class="line">            <span class="keyword">long</span> bytesReaded = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">			<span class="comment">//返回读取到的长度</span></span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">read</span><span class="params">(Buffer sink, <span class="keyword">long</span> byteCount)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                <span class="keyword">long</span> bytesRead = <span class="keyword">super</span>.read(sink, byteCount);</span><br><span class="line">                bytesReaded += bytesRead == -<span class="number">1</span> ? <span class="number">0</span> : bytesRead;</span><br><span class="line">                <span class="comment">// 通过RxBus发布进度信息</span></span><br><span class="line">                RxBus.getDefault().send(<span class="keyword">new</span> DownloadBean(contentLength(), bytesReaded));</span><br><span class="line">                <span class="keyword">return</span> bytesRead;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>　　上面的代码已经加了注解，如果对Okio不了解的同学可以参考下<a href="http://blog.csdn.net/sbsujjbcy/article/details/50523623" target="_blank" rel="noopener">这里</a>。</p>
<h2 id="配置网络接口"><a href="#配置网络接口" class="headerlink" title="配置网络接口"></a>配置网络接口</h2><p>　　由于是通过Retrofit2下载文件，返回的Obserable<t>泛型直接使用ResponseBody。<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">interface</span> <span class="title">Api</span> </span>&#123;</span><br><span class="line">	...</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Streaming</span><span class="comment">//注明为流文件，防止retrofit将大文件读入内存</span></span><br><span class="line">    <span class="meta">@GET</span></span><br><span class="line">    <span class="function">Observable&lt;ResponseBody&gt; <span class="title">down</span><span class="params">(@Url String url)</span></span>;<span class="comment">//通过@Url覆盖baseurl</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></t></p>
<p>　　实现网络接口：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Observable&lt;ResponseBody&gt; <span class="title">down</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">        OkHttpClient client = <span class="keyword">new</span> OkHttpClient.Builder()</span><br><span class="line">                .connectTimeout(NetConfig.CONNECT_TIME_OUT, TimeUnit.MILLISECONDS)</span><br><span class="line">                .addNetworkInterceptor(<span class="keyword">new</span> Interceptor() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> Response <span class="title">intercept</span><span class="params">(Chain chain)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">                        Response originalResponse = chain.proceed(chain.request());<span class="comment">//对结果重新处理</span></span><br><span class="line">                        <span class="keyword">return</span> originalResponse</span><br><span class="line">                                .newBuilder()</span><br><span class="line">                                .body(<span class="keyword">new</span> FileResponseBody(originalResponse))<span class="comment">//将自定义的ResposeBody设置给它</span></span><br><span class="line">                                .build();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">        Retrofit retrofit = <span class="keyword">new</span> Retrofit.Builder()</span><br><span class="line">                .client(client)</span><br><span class="line">                .addCallAdapterFactory(RxJava2CallAdapterFactory.create())</span><br><span class="line">                .build();</span><br><span class="line">        Api api = retrofit.create(Api.class);</span><br><span class="line">        <span class="keyword">return</span> api.down(url);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="封装UpdateManager"><a href="#封装UpdateManager" class="headerlink" title="封装UpdateManager"></a>封装UpdateManager</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateManager</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否需要更新,需要则下载</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context     上下文</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url         新版本地址</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> apkPath     本地apk保存路径</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cd          订阅关系集合，在数据传输完毕时解除订阅</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">downloadApk</span><span class="params">(<span class="keyword">final</span> Context context, <span class="keyword">final</span> String url, <span class="keyword">final</span> String apkPath, <span class="keyword">final</span> CompositeDisposable cd)</span> </span>&#123;</span><br><span class="line">        NetWork.getInstance().down(url)</span><br><span class="line">                .map(<span class="keyword">new</span> Function&lt;ResponseBody, BufferedSource&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> BufferedSource <span class="title">apply</span><span class="params">(ResponseBody responseBody)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">                        <span class="keyword">return</span> responseBody.source();<span class="comment">//获取数据缓冲源</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .subscribeOn(Schedulers.io())</span><br><span class="line">                .observeOn(Schedulers.io())</span><br><span class="line">                .subscribe(<span class="keyword">new</span> Observer&lt;BufferedSource&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</span><br><span class="line">                        cd.add(d);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(BufferedSource bufferedSource)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">try</span> &#123;</span><br><span class="line">                            writeFile(bufferedSource, <span class="keyword">new</span> File(apkPath));</span><br><span class="line">                        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">                            e.printStackTrace();</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                        unSubscribe(cd);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        <span class="comment">//安装apk</span></span><br><span class="line">                        Intent intent = <span class="keyword">new</span> Intent(Intent.ACTION_VIEW);</span><br><span class="line">                        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);</span><br><span class="line">                        intent.setDataAndType(Uri.fromFile(<span class="keyword">new</span> File(apkPath)), <span class="string">"application/vnd.android.package-archive"</span>);</span><br><span class="line">                        context.startActivity(intent);</span><br><span class="line"></span><br><span class="line">                        unSubscribe(cd);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 写入文件</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">writeFile</span><span class="params">(BufferedSource source, File file)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!file.getParentFile().exists())</span><br><span class="line">            file.getParentFile().mkdirs();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (file.exists())</span><br><span class="line">            file.delete();</span><br><span class="line"></span><br><span class="line">        BufferedSink bufferedSink = Okio.buffer(Okio.sink(file));</span><br><span class="line">        bufferedSink.writeAll(source);</span><br><span class="line"></span><br><span class="line">        bufferedSink.close();</span><br><span class="line">        source.close();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 解除订阅</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> cd 订阅关系集合</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">unSubscribe</span><span class="params">(CompositeDisposable cd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cd != <span class="keyword">null</span> &amp;&amp; !cd.isDisposed())</span><br><span class="line">            cd.dispose();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="通过IntentService下载apk文件"><a href="#通过IntentService下载apk文件" class="headerlink" title="通过IntentService下载apk文件"></a>通过IntentService下载apk文件</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyIntentService</span> <span class="keyword">extends</span> <span class="title">IntentService</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String ACTION_DOWNLOAD = <span class="string">"intentservice.action.download"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String DOWNLOAD_URL = <span class="string">"downloadUrl"</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String APK_PATH = <span class="string">"apkPath"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> CompositeDisposable cd = <span class="keyword">new</span> CompositeDisposable();</span><br><span class="line">    <span class="keyword">private</span> NotificationCompat.Builder builder;</span><br><span class="line">    <span class="keyword">private</span> NotificationManager notificationManager;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MyIntentService</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(<span class="string">"MyIntentService"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">startUpdateService</span><span class="params">(Context context, String url, String apkPath)</span> </span>&#123;</span><br><span class="line">        Intent intent = <span class="keyword">new</span> Intent(context, MyIntentService.class);</span><br><span class="line">        intent.setAction(ACTION_DOWNLOAD);</span><br><span class="line">        intent.putExtra(DOWNLOAD_URL, url);</span><br><span class="line">        intent.putExtra(APK_PATH, apkPath);</span><br><span class="line">        context.startService(intent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onHandleIntent</span><span class="params">(Intent intent)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (intent != <span class="keyword">null</span>) &#123;</span><br><span class="line">            String action = intent.getAction();</span><br><span class="line">            <span class="keyword">if</span> (ACTION_DOWNLOAD.equals(action)) &#123;</span><br><span class="line">                notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);</span><br><span class="line">                builder = <span class="keyword">new</span> NotificationCompat.Builder(<span class="keyword">this</span>)</span><br><span class="line">                        .setSmallIcon(R.mipmap.ic_launcher)</span><br><span class="line">                        .setContentTitle(<span class="string">"开始下载"</span>)</span><br><span class="line">                        .setAutoCancel(<span class="keyword">true</span>)</span><br><span class="line">                        .setContentText(<span class="string">"版本更新"</span>);</span><br><span class="line"></span><br><span class="line">                notificationManager.notify(<span class="number">0</span>, builder.build());</span><br><span class="line"></span><br><span class="line">                String url = intent.getStringExtra(DOWNLOAD_URL);</span><br><span class="line">                String apkPath = intent.getStringExtra(APK_PATH);</span><br><span class="line">                handleUpdate(url, apkPath);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">handleUpdate</span><span class="params">(String url, String apkPath)</span> </span>&#123;</span><br><span class="line">        subscribeEvent();<span class="comment">//订阅下载进度</span></span><br><span class="line">        UpdateManager.downloadApk(<span class="keyword">this</span>, url, apkPath, cd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">subscribeEvent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        RxBus.getDefault().toObservable(DownloadBean.class)</span><br><span class="line">                .subscribe(<span class="keyword">new</span> Observer&lt;DownloadBean&gt;() &#123;</span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onSubscribe</span><span class="params">(Disposable d)</span> </span>&#123;</span><br><span class="line">                        cd.add(d);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onNext</span><span class="params">(DownloadBean downloadBean)</span> </span>&#123;</span><br><span class="line">                        <span class="keyword">int</span> progress = (<span class="keyword">int</span>) Math.round(downloadBean.getBytesReaded() / (<span class="keyword">double</span>) downloadBean.getTotal() * <span class="number">100</span>);</span><br><span class="line">                        builder.setContentInfo(String.valueOf(progress) + <span class="string">"%"</span>).setProgress(<span class="number">100</span>, progress, <span class="keyword">false</span>);</span><br><span class="line">                        notificationManager.notify(<span class="number">0</span>, builder.build());</span><br><span class="line"></span><br><span class="line">                        <span class="keyword">if</span> (progress == <span class="number">100</span>)</span><br><span class="line">                            notificationManager.cancel(<span class="number">0</span>);</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onError</span><span class="params">(Throwable e)</span> </span>&#123;</span><br><span class="line">                        subscribeEvent();</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    <span class="meta">@Override</span></span><br><span class="line">                    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onComplete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">                        subscribeEvent();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onDestroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onDestroy();</span><br><span class="line">        System.out.println(<span class="string">"onDestory____MyIntentService"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="调用方式"><a href="#调用方式" class="headerlink" title="调用方式"></a>调用方式</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UpdateActivity</span> <span class="keyword">extends</span> <span class="title">BaseActivity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startDownload</span><span class="params">(View view)</span></span>&#123;</span><br><span class="line">		<span class="comment">//要下载的文件地址</span></span><br><span class="line">        String url = <span class="string">"http://www.izis.cn/mygoedu/yztv_1.apk"</span>;</span><br><span class="line">		<span class="comment">//下载后的保存路径</span></span><br><span class="line">        String apkPath = Environment.getExternalStorageDirectory().getPath() + <span class="string">"/yzkj.apk"</span>;</span><br><span class="line">        MyIntentService.startUpdateService(<span class="keyword">this</span>,url,apkPath);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="Demo地址"><a href="#Demo地址" class="headerlink" title="Demo地址"></a>Demo地址</h1><p>　　<a href="https://github.com/lunxinfeng/AndroidDemos" target="_blank" rel="noopener">传送门</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/RecyclerView的iiteem选中放大/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="风少侠">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="风少侠的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/RecyclerView的iiteem选中放大/" itemprop="url">RecyclerView的iiteem选中放大</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T12:33:40+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h1><p>　　最近在做的一个TV项目，我们知道TV一般是通过遥控器来进行选择的，因此有这样一个需求，需要在item被选中（获得焦点）时放大该item，电视不好录屏，效果图就不上了，大家应该都见过。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><p>　　首先假设我们的item是一个ImageButton（当然也可以是其他view），我们来自定义一个FoucseImageButton继承ImageButton，并重写onFocusChanged方法：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获得焦点时放大的ImageButton</span></span><br><span class="line"><span class="comment"> * Created by lxf on 2017/2/21.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FocuseImageButton</span> <span class="keyword">extends</span> <span class="title">ImageButton</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FocuseImageButton</span><span class="params">(Context context)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FocuseImageButton</span><span class="params">(Context context, AttributeSet attrs)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">FocuseImageButton</span><span class="params">(Context context, AttributeSet attrs, <span class="keyword">int</span> defStyleAttr)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>(context, attrs, defStyleAttr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onFocusChanged</span><span class="params">(<span class="keyword">boolean</span> gainFocus, <span class="keyword">int</span> direction, Rect previouslyFocusedRect)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">super</span>.onFocusChanged(gainFocus, direction, previouslyFocusedRect);</span><br><span class="line">        <span class="keyword">if</span> (gainFocus) &#123;</span><br><span class="line">            scaleUp();</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            scaleDown();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//1.08表示放大倍数,可以随便改</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scaleUp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ViewCompat.animate(<span class="keyword">this</span>)</span><br><span class="line">                .setDuration(<span class="number">200</span>)</span><br><span class="line">                .scaleX(<span class="number">1.08f</span>)</span><br><span class="line">                .scaleY(<span class="number">1.08f</span>)</span><br><span class="line">                .start();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">scaleDown</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ViewCompat.animate(<span class="keyword">this</span>)</span><br><span class="line">                .setDuration(<span class="number">200</span>)</span><br><span class="line">                .scaleX(<span class="number">1f</span>)</span><br><span class="line">                .scaleY(<span class="number">1f</span>)</span><br><span class="line">                .start();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>　　代码很简单，就是获取焦点时放大item，失去焦点时缩小item。当然，如果你的item是LinearLayout等，别忘了设置focusable为true。<br>　　看起来好像效果已经可以实现了，但是一运行发现并不是这么回事，你会发现第一行的item在放大时会被RecyclerView的边界遮挡住一部分，这时候只需要将RecyclerView的父布局的clipChildren设为false就好。<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;LinearLayout</span><br><span class="line">        android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">        android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">        android:paddingLeft=<span class="string">"40dp"</span></span><br><span class="line">        android:orientation=<span class="string">"vertical"</span></span><br><span class="line">        android:clipChildren=<span class="string">"false"</span></span><br><span class="line">        android:clipToPadding=<span class="string">"false"</span></span><br><span class="line">        tools:context=<span class="string">"cn.izis.yzgotvnew.ui.fragment.ExerciseFragment"</span>&gt;</span><br><span class="line"></span><br><span class="line">        &lt;ImageButton</span><br><span class="line">            android:layout_width=<span class="string">"wrap_content"</span></span><br><span class="line">            android:layout_height=<span class="string">"wrap_content"</span></span><br><span class="line">            android:src=<span class="string">"@drawable/sele_return"</span></span><br><span class="line">            android:background=<span class="string">"@null"</span></span><br><span class="line">            android:layout_marginTop=<span class="string">"20dp"</span></span><br><span class="line">            android:layout_marginBottom=<span class="string">"20dp"</span></span><br><span class="line">            android:onClick=<span class="string">"@&#123;fragment.finish&#125;"</span></span><br><span class="line">            /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;lxf.widget.recyclerview.LoadMoreRecyclerView</span><br><span class="line">            android:id=<span class="string">"@+id/recy_exer_title2"</span></span><br><span class="line">            android:layout_width=<span class="string">"match_parent"</span></span><br><span class="line">            android:layout_height=<span class="string">"match_parent"</span></span><br><span class="line">            /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/LinearLayout&gt;</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">风少侠</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">风少侠</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
